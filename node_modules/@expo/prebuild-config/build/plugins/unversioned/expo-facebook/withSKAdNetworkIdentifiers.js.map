{"version":3,"sources":["../../../../src/plugins/unversioned/expo-facebook/withSKAdNetworkIdentifiers.ts"],"names":["withSKAdNetworkIdentifiers","config","identifiers","facebookAppId","ios","infoPlist","Array","isArray","SKAdNetworkItems","existingIds","map","item","SKAdNetworkIdentifier","filter","Boolean","Set","id","lower","toLowerCase","includes","push"],"mappings":";;;;;;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMA,0BAAkD,GAAG,CAACC,MAAD,EAASC,WAAT,KAAyB;AACzF;AACA,QAAMC,aAAa,GAAG,yCAAiBF,MAAjB,CAAtB;;AACA,MAAI,CAACE,aAAL,EAAoB;AAClB,WAAOF,MAAP;AACD;;AAED,MAAI,CAACA,MAAM,CAACG,GAAZ,EAAiB;AACfH,IAAAA,MAAM,CAACG,GAAP,GAAa,EAAb;AACD;;AACD,MAAI,CAACH,MAAM,CAACG,GAAP,CAAWC,SAAhB,EAA2B;AACzBJ,IAAAA,MAAM,CAACG,GAAP,CAAWC,SAAX,GAAuB,EAAvB;AACD;;AACD,MAAI,CAACC,KAAK,CAACC,OAAN,CAAcN,MAAM,CAACG,GAAP,CAAWC,SAAX,CAAqBG,gBAAnC,CAAL,EAA2D;AACzDP,IAAAA,MAAM,CAACG,GAAP,CAAWC,SAAX,CAAqBG,gBAArB,GAAwC,EAAxC;AACD,GAfwF,CAiBzF;;;AACA,MAAIC,WAAW,GAAGR,MAAM,CAACG,GAAP,CAAWC,SAAX,CAAqBG,gBAArB,CAAsCE,GAAtC,CACfC,IAAD;AAAA;;AAAA,oCAAeA,IAAf,aAAeA,IAAf,uBAAeA,IAAI,CAAEC,qBAArB,yEAA8C,IAA9C;AAAA,GADgB,EAEhBC,MAFgB,CAETC,OAFS,CAAlB,CAlByF,CAqBzF;;AACAL,EAAAA,WAAW,GAAG,CAAC,GAAG,IAAIM,GAAJ,CAAQN,WAAR,CAAJ,CAAd;;AAEA,OAAK,MAAMO,EAAX,IAAiBd,WAAjB,EAA8B;AAC5B;AACA,UAAMe,KAAK,GAAGD,EAAE,CAACE,WAAH,EAAd;;AACA,QAAI,CAACT,WAAW,CAACU,QAAZ,CAAqBF,KAArB,CAAL,EAAkC;AAChChB,MAAAA,MAAM,CAACG,GAAP,CAAWC,SAAX,CAAqBG,gBAArB,CAAsCY,IAAtC,CAA2C;AACzCR,QAAAA,qBAAqB,EAAEK;AADkB,OAA3C;AAGD;AACF;;AAED,SAAOhB,MAAP;AACD,CAnCM","sourcesContent":["import { ConfigPlugin } from '@expo/config-plugins';\n\nimport { getFacebookAppId } from './withIosFacebook';\n\n/**\n * Plugin to add [`SKAdNetworkIdentifier`](https://developer.apple.com/documentation/storekit/skadnetwork/configuring_the_participating_apps)s to the Info.plist safely.\n *\n *\n * @param config\n * @param props.identifiers array of lowercase string ids to push to the `SKAdNetworkItems` array in the `Info.plist`.\n */\nexport const withSKAdNetworkIdentifiers: ConfigPlugin<string[]> = (config, identifiers) => {\n  // Only add the iOS ad network values if facebookAppId is defined.\n  const facebookAppId = getFacebookAppId(config);\n  if (!facebookAppId) {\n    return config;\n  }\n\n  if (!config.ios) {\n    config.ios = {};\n  }\n  if (!config.ios.infoPlist) {\n    config.ios.infoPlist = {};\n  }\n  if (!Array.isArray(config.ios.infoPlist.SKAdNetworkItems)) {\n    config.ios.infoPlist.SKAdNetworkItems = [];\n  }\n\n  // Get ids\n  let existingIds = config.ios.infoPlist.SKAdNetworkItems.map(\n    (item: any) => item?.SKAdNetworkIdentifier ?? null\n  ).filter(Boolean) as string[];\n  // remove duplicates\n  existingIds = [...new Set(existingIds)];\n\n  for (const id of identifiers) {\n    // Must be lowercase\n    const lower = id.toLowerCase();\n    if (!existingIds.includes(lower)) {\n      config.ios.infoPlist.SKAdNetworkItems.push({\n        SKAdNetworkIdentifier: lower,\n      });\n    }\n  }\n\n  return config;\n};\n"],"file":"withSKAdNetworkIdentifiers.js"}