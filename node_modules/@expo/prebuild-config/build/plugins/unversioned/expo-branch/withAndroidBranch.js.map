{"version":3,"sources":["../../../../src/plugins/unversioned/expo-branch/withAndroidBranch.ts"],"names":["addMetaDataItemToMainApplication","getMainApplicationOrThrow","removeMetaDataItemFromMainApplication","AndroidConfig","Manifest","META_BRANCH_KEY","withAndroidBranch","config","modResults","setBranchApiKey","getBranchApiKey","android","branch","apiKey","androidManifest","mainApplication"],"mappings":";;;;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAGA,MAAM;AACJA,EAAAA,gCADI;AAEJC,EAAAA,yBAFI;AAGJC,EAAAA;AAHI,IAIFC,+BAAcC,QAJlB;;AAMA,MAAMC,eAAe,GAAG,yBAAxB;;AAEO,MAAMC,iBAA+B,GAAGC,MAAM,IAAI;AACvD,SAAO,0CAAoBA,MAApB,EAA4BA,MAAM,IAAI;AAC3CA,IAAAA,MAAM,CAACC,UAAP,GAAoBC,eAAe,CAACF,MAAD,EAASA,MAAM,CAACC,UAAhB,CAAnC;AACA,WAAOD,MAAP;AACD,GAHM,CAAP;AAID,CALM;;;;AAOA,SAASG,eAAT,CAAyBH,MAAzB,EAA6C;AAAA;;AAClD,qDAAOA,MAAM,CAACI,OAAd,8EAAO,gBAAgBJ,MAAvB,qFAAO,uBAAwBK,MAA/B,2DAAO,uBAAgCC,MAAvC,yEAAiD,IAAjD;AACD;;AAEM,SAASJ,eAAT,CACLF,MADK,EAELO,eAFK,EAGL;AACA,QAAMD,MAAM,GAAGH,eAAe,CAACH,MAAD,CAA9B;AAEA,QAAMQ,eAAe,GAAGd,yBAAyB,CAACa,eAAD,CAAjD;;AAEA,MAAID,MAAJ,EAAY;AACV;AACAb,IAAAA,gCAAgC,CAACe,eAAD,EAAkBV,eAAlB,EAAmCQ,MAAnC,CAAhC;AACD,GAHD,MAGO;AACL;AACAX,IAAAA,qCAAqC,CAACa,eAAD,EAAkBV,eAAlB,CAArC;AACD;;AACD,SAAOS,eAAP;AACD","sourcesContent":["import { AndroidConfig, ConfigPlugin, withAndroidManifest } from '@expo/config-plugins';\nimport { ExpoConfig } from '@expo/config-types';\n\nconst {\n  addMetaDataItemToMainApplication,\n  getMainApplicationOrThrow,\n  removeMetaDataItemFromMainApplication,\n} = AndroidConfig.Manifest;\n\nconst META_BRANCH_KEY = 'io.branch.sdk.BranchKey';\n\nexport const withAndroidBranch: ConfigPlugin = config => {\n  return withAndroidManifest(config, config => {\n    config.modResults = setBranchApiKey(config, config.modResults);\n    return config;\n  });\n};\n\nexport function getBranchApiKey(config: ExpoConfig) {\n  return config.android?.config?.branch?.apiKey ?? null;\n}\n\nexport function setBranchApiKey(\n  config: ExpoConfig,\n  androidManifest: AndroidConfig.Manifest.AndroidManifest\n) {\n  const apiKey = getBranchApiKey(config);\n\n  const mainApplication = getMainApplicationOrThrow(androidManifest);\n\n  if (apiKey) {\n    // If the item exists, add it back\n    addMetaDataItemToMainApplication(mainApplication, META_BRANCH_KEY, apiKey);\n  } else {\n    // Remove any existing item\n    removeMetaDataItemFromMainApplication(mainApplication, META_BRANCH_KEY);\n  }\n  return androidManifest;\n}\n"],"file":"withAndroidBranch.js"}