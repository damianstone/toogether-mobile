{"version":3,"file":"withAndroidBranch.js","names":["addMetaDataItemToMainApplication","getMainApplicationOrThrow","removeMetaDataItemFromMainApplication","AndroidConfig","Manifest","META_BRANCH_KEY","withAndroidBranch","config","withAndroidManifest","modResults","setBranchApiKey","getBranchApiKey","android","branch","apiKey","androidManifest","mainApplication"],"sources":["../../../../src/plugins/unversioned/expo-branch/withAndroidBranch.ts"],"sourcesContent":["import { AndroidConfig, ConfigPlugin, withAndroidManifest } from '@expo/config-plugins';\nimport { ExpoConfig } from '@expo/config-types';\n\nconst {\n  addMetaDataItemToMainApplication,\n  getMainApplicationOrThrow,\n  removeMetaDataItemFromMainApplication,\n} = AndroidConfig.Manifest;\n\nconst META_BRANCH_KEY = 'io.branch.sdk.BranchKey';\n\nexport const withAndroidBranch: ConfigPlugin = (config) => {\n  return withAndroidManifest(config, (config) => {\n    config.modResults = setBranchApiKey(config, config.modResults);\n    return config;\n  });\n};\n\nexport function getBranchApiKey(config: ExpoConfig) {\n  return config.android?.config?.branch?.apiKey ?? null;\n}\n\nexport function setBranchApiKey(\n  config: ExpoConfig,\n  androidManifest: AndroidConfig.Manifest.AndroidManifest\n) {\n  const apiKey = getBranchApiKey(config);\n\n  const mainApplication = getMainApplicationOrThrow(androidManifest);\n\n  if (apiKey) {\n    // If the item exists, add it back\n    addMetaDataItemToMainApplication(mainApplication, META_BRANCH_KEY, apiKey);\n  } else {\n    // Remove any existing item\n    removeMetaDataItemFromMainApplication(mainApplication, META_BRANCH_KEY);\n  }\n  return androidManifest;\n}\n"],"mappings":";;;;;;;;;AAAA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAGA,MAAM;EACJA,gCADI;EAEJC,yBAFI;EAGJC;AAHI,IAIFC,8BAAA,CAAcC,QAJlB;;AAMA,MAAMC,eAAe,GAAG,yBAAxB;;AAEO,MAAMC,iBAA+B,GAAIC,MAAD,IAAY;EACzD,OAAO,IAAAC,oCAAA,EAAoBD,MAApB,EAA6BA,MAAD,IAAY;IAC7CA,MAAM,CAACE,UAAP,GAAoBC,eAAe,CAACH,MAAD,EAASA,MAAM,CAACE,UAAhB,CAAnC;IACA,OAAOF,MAAP;EACD,CAHM,CAAP;AAID,CALM;;;;AAOA,SAASI,eAAT,CAAyBJ,MAAzB,EAA6C;EAAA;;EAClD,mDAAOA,MAAM,CAACK,OAAd,8EAAO,gBAAgBL,MAAvB,qFAAO,uBAAwBM,MAA/B,2DAAO,uBAAgCC,MAAvC,yEAAiD,IAAjD;AACD;;AAEM,SAASJ,eAAT,CACLH,MADK,EAELQ,eAFK,EAGL;EACA,MAAMD,MAAM,GAAGH,eAAe,CAACJ,MAAD,CAA9B;EAEA,MAAMS,eAAe,GAAGf,yBAAyB,CAACc,eAAD,CAAjD;;EAEA,IAAID,MAAJ,EAAY;IACV;IACAd,gCAAgC,CAACgB,eAAD,EAAkBX,eAAlB,EAAmCS,MAAnC,CAAhC;EACD,CAHD,MAGO;IACL;IACAZ,qCAAqC,CAACc,eAAD,EAAkBX,eAAlB,CAArC;EACD;;EACD,OAAOU,eAAP;AACD"}