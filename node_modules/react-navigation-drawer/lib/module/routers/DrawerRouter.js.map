{"version":3,"sources":["DrawerRouter.tsx"],"names":["SwitchRouter","NavigationActions","DrawerActions","withDefaultValue","obj","key","defaultValue","hasOwnProperty","getActiveRouteKey","route","routes","index","routeConfigs","config","unmountInactiveRoutes","resetOnBlur","switchRouter","getActionCreators","navStateKey","openDrawer","closeDrawer","toggleDrawer","getStateForAction","action","state","undefined","isDrawerOpen","isRouterTargeted","type","CLOSE_DRAWER","BACK","OPEN_DRAWER","TOGGLE_DRAWER","switchedState"],"mappings":"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","sourcesContent":["import {\n  SwitchRouter,\n  NavigationActions,\n  NavigationAction,\n  NavigationRoute,\n  NavigationRouteConfigMap,\n} from 'react-navigation';\nimport * as DrawerActions from './DrawerActions';\n\ntype State = NavigationRoute & {\n  isDrawerOpen?: any;\n};\n\nfunction withDefaultValue(obj: object, key: string, defaultValue: any): any {\n  // @ts-ignore\n  if (obj.hasOwnProperty(key) && typeof obj[key] !== 'undefined') {\n    return obj;\n  }\n\n  // @ts-ignore\n  obj[key] = defaultValue;\n  return obj;\n}\n\nconst getActiveRouteKey = (route: NavigationRoute): string => {\n  if (\n    route.routes &&\n    typeof route.index === 'number' &&\n    route.routes[route.index]\n  ) {\n    return getActiveRouteKey(route.routes[route.index]);\n  }\n\n  return route.key;\n};\n\nexport default (\n  routeConfigs: NavigationRouteConfigMap<any, any>,\n  config: {\n    unmountInactiveRoutes?: boolean;\n    resetOnBlur?: boolean;\n    initialRouteName?: string;\n  } = {}\n) => {\n  config = { ...config };\n  config = withDefaultValue(\n    config,\n    'resetOnBlur',\n    config.unmountInactiveRoutes ? true : !!config.resetOnBlur\n  );\n  config = withDefaultValue(config, 'backBehavior', 'initialRoute');\n\n  const switchRouter = SwitchRouter(routeConfigs, config);\n\n  return {\n    ...switchRouter,\n\n    getActionCreators(route: NavigationRoute, navStateKey: string) {\n      return {\n        openDrawer: () => DrawerActions.openDrawer({ key: navStateKey }),\n        closeDrawer: () => DrawerActions.closeDrawer({ key: navStateKey }),\n        toggleDrawer: () => DrawerActions.toggleDrawer({ key: navStateKey }),\n        ...switchRouter.getActionCreators(route, navStateKey),\n      };\n    },\n\n    getStateForAction(action: NavigationAction, state?: State) {\n      // Set up the initial state if needed\n      if (!state) {\n        return {\n          ...switchRouter.getStateForAction(action, undefined),\n          isDrawerOpen: false,\n        };\n      }\n\n      const isRouterTargeted = action.key == null || action.key === state.key;\n\n      if (isRouterTargeted) {\n        // Only handle actions that are meant for this drawer, as specified by action.key.\n        if (\n          action.type === DrawerActions.CLOSE_DRAWER ||\n          (action.type === NavigationActions.BACK && state.isDrawerOpen)\n        ) {\n          return {\n            ...state,\n            isDrawerOpen: false,\n          };\n        }\n\n        if (action.type === DrawerActions.OPEN_DRAWER) {\n          return {\n            ...state,\n            isDrawerOpen: true,\n          };\n        }\n\n        if (action.type === DrawerActions.TOGGLE_DRAWER) {\n          return {\n            ...state,\n            isDrawerOpen: !state.isDrawerOpen,\n          };\n        }\n      }\n\n      // Fall back on switch router for screen switching logic, and handling of child routers\n      const switchedState = switchRouter.getStateForAction(action, state);\n\n      if (switchedState === null) {\n        // The switch router or a child router is attempting to swallow this action. We return null to allow this.\n        return null;\n      }\n\n      // Has the switch router changed the state?\n      if (switchedState !== state) {\n        // If any navigation has happened, and the drawer is maybe open, make sure to close it\n        if (\n          getActiveRouteKey(switchedState) !== getActiveRouteKey(state) &&\n          state.isDrawerOpen\n        ) {\n          return {\n            ...switchedState,\n            isDrawerOpen: false,\n          };\n        }\n\n        // At this point, return the state as defined by the switch router.\n        // The active route key hasn't changed, so this most likely means that a child router has returned\n        // a new state like a param change, but the same key is still active and the drawer will remain open\n        return switchedState;\n      }\n\n      return state;\n    },\n  };\n};\n"]}