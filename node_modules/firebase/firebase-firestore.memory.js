!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Qf){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Qf),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=u=u||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){e=d.call(this,e)||this;return e.code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var h=a[u];"_"!==h.slice(-1)&&(h in s&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),s[h]=i[h])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O={},S=R||self;function D(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function V(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function _(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),k=0;function j(t,e,n){return t.call.apply(t.bind,arguments)}function P(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?j:P).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,U)&&t[U]||(t[U]=++k))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var H,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var J=S.navigator;if(J){J=J.userAgent;if(J){H=J;break t}}H=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=D;var rt,it=K(H,"Opera"),ot=K(H,"Trident")||K(H,"MSIE"),st=K(H,"Edge"),ut=st||ot,at=K(H,"Gecko")&&!(K(H.toLowerCase(),"webkit")&&!K(H,"Edge"))&&!(K(H,"Trident")||K(H,"MSIE"))&&!K(H,"Edge"),ht=K(H.toLowerCase(),"webkit")&&!K(H,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=H,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ht?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ct();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=X(String(rt)).split("."),n=X(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=S.document&&ot?ct()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},F(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Rt(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Rt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Vt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=xt(r);return e&&e[It]?e.wa(n,r,_(i)?!!i.capture:!!i,o):_t(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=xt(n),t&&t[It]?t.va(e,n,_(r)?!!r.capture:!!r,i):_t(t,e,n,!1,r,i)}function _t(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=_(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,h=Ct(t);if(h||(t[Dt]=h=new Rt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Pt,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?Ot(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Dt]=null)):Nt(t)))}function kt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function jt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ut(t),n.call(r,e)}function Pt(t,e){if(t.Y)return!0;if(vt)return jt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return jt(t,e=new bt(e,this))}function Ct(t){return(t=t[Dt])instanceof Rt?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(e){return"function"==L(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function Ft(){q.call(this),this.c=new Rt(this),(this.J=this).C=null}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Ot(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,q),Ft.prototype[It]=!0,(N=Ft.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=_(i)?!!i.capture:!!i,r=xt(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=qt(o,r,!0,t)&&s;if(s=qt(o=t.a=n,r,!0,t)&&s,s=qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=qt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(Ft.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=S.JSON.stringify;function Gt(){this.b=this.a=null}var zt,Wt=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Ht},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Ht(){this.next=this.b=this.a=null}function Xt(t,e){var n;zt||(n=S.Promise.resolve(void 0),zt=function(){n.then(Jt)}),Kt||(zt(),Kt=!0),Yt.add(t,e)}Gt.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(Ht.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Gt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Wt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Kt=!1}function $t(t,e){Ft.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ya,this),this.g=x()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==L(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F($t,Ft),(N=$t.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){$t.S.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){q.call(this),this.b=t,this.a={}}F(ue,q);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function le(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var pe=null;function de(){return pe=pe||new Ft}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}F(ye,wt),F(ge,wt),F(we,wt);var Ee={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Re,R={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Oe(){wt.call(this,"d")}function Se(){wt.call(this,"c")}function De(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=Ve,t=ut?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Oe,wt),F(Se,wt),F(De,Te),Re=new De;var Ve=45e3,_e={},Ue={};function ke(t,e,n){t.H=1,t.i=en(Ke(e)),t.j=n,t.I=!0,je(t,null)}function je(t,e){t.u=x(),Ce(t),t.l=Ke(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(C(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ue:(i=Number(u.substring(i,o)),isNaN(i)?_e:(o+=1)+i>u.length?Ue:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ue){4==e&&(t.h=4,me(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==_e){t.h=4,me(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),Fe(t))}function Ce(t){t.U=x()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(C(t.Ua,t),e)}function xe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||rr(t.g,t)}function qe(t){xe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),Wn(u)}Zn(u),me(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(C(u.Ra,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!Q(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(K(r,"spdy")||K(r,"quic")||K(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(xe(o),Ce(o)),n.a=i):$n(n),0<u.g.length&&Xn(u)):"stop"!=h[0]&&"close"!=h[0]||or(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?or(u,7):zn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ve(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(V(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(V(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(V(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Le.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),xe(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),qe(this),Fe(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(Pe(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),Be(this,n)),4==e&&qe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),qe(this),Fe(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(xe(this),Pe(this,t,e),this.b&&4!=t&&Ce(this)))},N.cancel=function(){this.A=!0,qe(this)},N.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),qe(this),this.h=2,Fe(this)):Me(this,this.U-n)},(N=ze.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return We(this),this.a.concat()},N.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},N.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Je(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(He))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),$e(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ke(t){return new Xe(t)}function Ye(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,hn)),t.b=new ln(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,cn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,hn=/[#\?@]/g,cn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){fn(t),e=vn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function dn(t,e){return fn(t),e=vn(t,e),Qe(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),W(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=ln.prototype).add=function(t,e){fn(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){fn(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return fn(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Rn(){}function On(){this.a=new Rn}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function Ln(t){Ft.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vn,this.D=this.F=!1}F(Ln,Ft);var Vn="",_n=/^https?$/i,Un=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function jn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Mn(t)}function Pn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&void 0!==O&&(!t.s[1]||4!=Fn(t)||2!=t.X()))if(t.l&&4==Fn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(He)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!_n.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Pn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){xn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function xn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Bn("baseRetryDelayMs",5e3,t),this.Ma=Bn("retryDelaySeedMs",1e4,t),this.Ja=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function zn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,tn(n=Ke(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Yn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=en(Ke(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=x(),Ce(e)),sr(t)}function Wn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Qn(t){Wn(t),t.j&&(S.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Hn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Xn(t)}function Xn(t){bn(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Kn(t,e){var n=e?e.f:t.R++,r=Ke(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Yn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),ke(n,r,e)}function Yn(t,n){t.f&&Ge({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;_(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.U=1,Xt(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(C(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function er(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Yn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Ke(e)),n.j=null,n.I=!0,je(n,t)}function nr(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Xn(t)):$n(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(C(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Xa,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Ye(r,"https"),en(r)),n=r.toString(),r=o,o=new le,S.Image?((i=new Image).onload=M(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Qn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Ke(s):new Xe(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),$e(a,a.h)):(u=S.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Ye(u,r),i&&Je(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.W&&$(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Yn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function hr(){}function cr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){Ft.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function fr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){Se.call(this),this.status=1}function dr(t){this.a=t}(N=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Re),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void jn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=B(Un,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){jn(this,t)}},N.xa=function(){void 0!==O&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Ln.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},N.Ta=function(){Cn(this)},N.X=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Gn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=Ke(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Yn(this,i),this.i&&r&&qn(i,this.i,r),Tn(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||bn(this.b)||Kn(this))},N.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(C(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Wn(this),er(this))},N.Ra=function(){null!=this.m&&(this.m=null,Wn(this),Zn(this),me(19))},N.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},cr.prototype.a=function(t,e){return new lr(t,e)},F(lr,Ft),(N=lr.prototype).addEventListener=function(t,e,n,r){lr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){lr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Xn(t)},N.close=function(){zn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Hn(this.a,e)):this.g?((e={}).__data__=Bt(t),Hn(this.a,e)):Hn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,lr.S.G.call(this)},F(fr,Oe),F(pr,Se),F(dr,hr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,lr.prototype.send=lr.prototype.Pa,lr.prototype.open=lr.prototype.Oa,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ne.EventType=R).OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var yr=Ee,vr=Ie,gr=Ne,mr=Ln,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Tr=(n(Nr,Er=Error),Nr),Ar=new l("@firebase/firestore");function Nr(t,e){var n=this;return(n=Er.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Rr(){return Ar.logLevel}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.DEBUG&&(e=n.map(Lr),Ar.debug.apply(Ar,i(["Firestore (7.24.0): "+t],e)))}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.ERROR&&(e=n.map(Lr),Ar.error.apply(Ar,i(["Firestore (7.24.0): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.WARN&&(e=n.map(Lr),Ar.warn.apply(Ar,i(["Firestore (7.24.0): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Vr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (7.24.0) INTERNAL ASSERTION FAILED: "+t;throw Sr(t),new Error(t)}function _r(t){t||Vr()}function Ur(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function kr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Pr,Cr,l=(Object.defineProperty(Wr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Wr.prototype.isEqual=function(t){return 0===Wr.i(this,t)},Wr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Wr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Wr.prototype.limit=function(){return this.offset+this.length},Wr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Wr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Wr.prototype.l=function(){return this.segments[this.offset]},Wr.prototype._=function(){return this.get(this.length-1)},Wr.prototype.get=function(t){return this.segments[this.offset+t]},Wr.prototype.m=function(){return 0===this.length},Wr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Wr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Wr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Wr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Wr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Wr),Mr=(n(zr,Cr=l),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.prototype.R=function(){return this.A().join("/")},zr.prototype.toString=function(){return this.R()},zr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new zr(n)},zr.g=function(){return new zr([])},zr),xr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Fr=(n(Gr,Pr=l),Gr.prototype.o=function(t,e,n){return new Gr(t,e,n)},Gr.p=function(t){return xr.test(t)},Gr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Gr.p(t)||(t="`"+t+"`"),t}).join(".")},Gr.prototype.toString=function(){return this.R()},Gr.prototype.V=function(){return 1===this.length&&"__name__"===this.get(0)},Gr.v=function(){return new Gr(["__name__"])},Gr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Tr(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Tr(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Gr(e)},Gr.g=function(){return new Gr([])},Gr),qr=(Br.D=function(t){return new Br(Mr.P(t))},Br.C=function(t){return new Br(Mr.P(t).u(5))},Br.prototype.F=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Br.prototype.isEqual=function(t){return null!==t&&0===Mr.i(this.path,t.path)},Br.prototype.toString=function(){return this.path.toString()},Br.i=function(t,e){return Mr.i(t.path,e.path)},Br.N=function(t){return t.length%2==0},Br.$=function(t){return new Br(new Mr(t.slice()))},Br);function Br(t){this.path=t}function Gr(){return null!==Pr&&Pr.apply(this,arguments)||this}function zr(){return null!==Cr&&Cr.apply(this,arguments)||this}function Wr(t,e,n){void 0===e?e=0:e>t.length&&Vr(),void 0===n?n=t.length-e:n>t.length-e&&Vr(),this.segments=t,this.offset=e,this.t=n}function Qr(t,e){if(0!==e.length)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ci(e.length,"argument")+".")}function Hr(t,e,n){if(e.length!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires "+ci(n,"argument")+", but was called with "+ci(e.length,"argument")+".")}function Xr(t,e,n){if(e.length<n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ci(n,"argument")+", but was called with "+ci(e.length,"argument")+".")}function Kr(t,e,n,r){if(e.length<n||e.length>r)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ci(e.length,"argument")+".")}function Yr(t,e,n,r){ni(t,e,hi(n)+" argument",r)}function Jr(t,e,n,r){void 0!==r&&Yr(t,e,n,r)}function $r(t,e,n,r){ni(t,e,n+" option",r)}function Zr(t,e,n,r){void 0!==r&&$r(t,e,n,r)}function ti(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(ii(s))}var u=ii(n);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ei(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+ii(r)+" provided to function "+t+"() for its "+hi(n)+" argument. Acceptable values: "+e.join(", "));return r}function ni(t,e,n,r){if(!("object"===e?ri(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){r=ii(r);throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function ri(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ii(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Vr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function oi(t,e,n){if(void 0===n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+hi(e)+" argument, but it was undefined.")}function si(n,t,r){kr(t,function(t,e){if(r.indexOf(t)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ui(t,e,n,r){r=ii(r);return new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(n)+" argument to be a "+e+", but it was: "+r)}function ai(t,e,n){if(n<=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(e)+" argument to be a positive number, but it was: "+n+".")}function hi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ci(t,e){return t+" "+e+(1===t?"":"s")}var li=(fi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},fi);function fi(){}function pi(t,e){return t<e?-1:e<t?1:0}function di(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var yi=(vi.fromBase64String=function(t){return new vi(atob(t))},vi.fromUint8Array=function(t){return new vi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},vi.prototype.toBase64=function(){return t=this.O,btoa(t);var t},vi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},vi.prototype.L=function(){return 2*this.O.length},vi.prototype.M=function(t){return pi(this.O,t.O)},vi.prototype.isEqual=function(t){return this.O===t.O},vi);function vi(t){this.O=t}yi.q=new yi("");var gi=(mi.fromBase64String=function(t){try{return new mi(yi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},mi.fromUint8Array=function(t){return new mi(yi.fromUint8Array(t))},mi.prototype.toBase64=function(){return this.U.toBase64()},mi.prototype.toUint8Array=function(){return this.U.toUint8Array()},mi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},mi.prototype.isEqual=function(t){return this.U.isEqual(t.U)},mi);function mi(t){this.U=t}function wi(){if("undefined"==typeof Uint8Array)throw new Tr(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function bi(){if("undefined"==typeof atob)throw new Tr(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ei(t,e,n,r,i,o){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.j=o}var Ii,Ti=(n(_i,Ii=gi),_i.fromBase64String=function(t){Hr("Blob.fromBase64String",arguments,1),Yr("Blob.fromBase64String","string",1,t),bi();try{return new _i(yi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},_i.fromUint8Array=function(t){if(Hr("Blob.fromUint8Array",arguments,1),wi(),!(t instanceof Uint8Array))throw ui("Blob.fromUint8Array","Uint8Array",1,t);return new _i(yi.fromUint8Array(t))},_i.prototype.toBase64=function(){return Hr("Blob.toBase64",arguments,0),bi(),Ii.prototype.toBase64.call(this)},_i.prototype.toUint8Array=function(){return Hr("Blob.toUint8Array",arguments,0),wi(),Ii.prototype.toUint8Array.call(this)},_i.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},_i),Ai=(Object.defineProperty(Vi.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Vi.prototype.isEqual=function(t){return t instanceof Vi&&t.projectId===this.projectId&&t.database===this.database},Vi.prototype.M=function(t){return pi(this.projectId,t.projectId)||pi(this.database,t.database)},Vi),Ni=(Li.prototype.get=function(t){var e=this.G(t),e=this.H[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.K(o,t))return i}},Li.prototype.has=function(t){return void 0!==this.get(t)},Li.prototype.set=function(t,e){var n=this.G(t),r=this.H[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.H[n]=[[t,e]]},Li.prototype.delete=function(t){var e=this.G(t),n=this.H[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.H[e]:n.splice(r,1),!0;return!1},Li.prototype.forEach=function(s){kr(this.H,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Li.prototype.m=function(){return jr(this.H)},Li),Ri=(Di.now=function(){return Di.fromMillis(Date.now())},Di.fromDate=function(t){return Di.fromMillis(t.getTime())},Di.fromMillis=function(t){var e=Math.floor(t/1e3);return new Di(e,1e6*(t-1e3*e))},Di.prototype.toDate=function(){return new Date(this.toMillis())},Di.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Di.prototype.Y=function(t){return this.seconds===t.seconds?pi(this.nanoseconds,t.nanoseconds):pi(this.seconds,t.seconds)},Di.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Di.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Di.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Di.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Di),Oi=(Si.J=function(t){return new Si(t)},Si.min=function(){return new Si(new Ri(0,0))},Si.prototype.M=function(t){return this.timestamp.Y(t.timestamp)},Si.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Si.prototype.X=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Si.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Si.prototype.Z=function(){return this.timestamp},Si);function Si(t){this.timestamp=t}function Di(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Li(t,e){this.G=t,this.K=e,this.H={}}function Vi(t,e){this.projectId=t,this.database=e||"(default)"}function _i(){return null!==Ii&&Ii.apply(this,arguments)||this}function Ui(t){return null==t}function ki(t){return 0===t&&1/t==-1/0}var ji=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function Pi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ji(t,e,n,r,i,o,s)}function Ci(t){var e=t;return null===e.tt&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Co(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ui(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=sa(e.startAt)),e.endAt&&(t+="|ub:",t+=sa(e.endAt)),e.tt=t),e.tt}function Mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Uo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!aa(t.startAt,e.startAt)&&aa(t.endAt,e.endAt)}function xi(t){return qr.N(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Fi(t){this.count=t}var qi,Bi=(Gi.prototype.st=function(t){return new Gi(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Gi.prototype.it=function(t,e){return new Gi(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Gi.prototype.rt=function(t){return new Gi(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Gi);function Gi(t,e,n,r,i,o,s){void 0===i&&(i=Oi.min()),void 0===o&&(o=Oi.min()),void 0===s&&(s=yi.q),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function zi(t){switch(t){case Ir.OK:return Vr(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return Vr(),0}}function Wi(t){if(void 0===t)return Sr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case qi.OK:return Ir.OK;case qi.CANCELLED:return Ir.CANCELLED;case qi.UNKNOWN:return Ir.UNKNOWN;case qi.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case qi.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case qi.INTERNAL:return Ir.INTERNAL;case qi.UNAVAILABLE:return Ir.UNAVAILABLE;case qi.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case qi.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case qi.NOT_FOUND:return Ir.NOT_FOUND;case qi.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case qi.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case qi.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case qi.ABORTED:return Ir.ABORTED;case qi.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case qi.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case qi.DATA_LOSS:return Ir.DATA_LOSS;default:return Vr()}}(l=qi=qi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Qi=(Ji.prototype.ot=function(t,e){return new Ji(this.i,this.root.ot(t,e,this.i).copy(null,null,Xi.ut,null,null))},Ji.prototype.remove=function(t){return new Ji(this.i,this.root.remove(t,this.i).copy(null,null,Xi.ut,null,null))},Ji.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ji.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ji.prototype.m=function(){return this.root.m()},Object.defineProperty(Ji.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ji.prototype.ct=function(){return this.root.ct()},Ji.prototype.at=function(){return this.root.at()},Ji.prototype.ht=function(t){return this.root.ht(t)},Ji.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Ji.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ji.prototype.lt=function(t){return this.root.lt(t)},Ji.prototype._t=function(){return new Hi(this.root,null,this.i,!1)},Ji.prototype.ft=function(t){return new Hi(this.root,t,this.i,!1)},Ji.prototype.dt=function(){return new Hi(this.root,null,this.i,!0)},Ji.prototype.wt=function(t){return new Hi(this.root,t,this.i,!0)},Ji),Hi=(Yi.prototype.It=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},Yi.prototype.At=function(){return 0<this.Et.length},Yi.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},Yi),Xi=(Ki.prototype.copy=function(t,e,n,r,i){return new Ki(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ki.prototype.m=function(){return!1},Ki.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Ki.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Ki.prototype.min=function(){return this.left.m()?this:this.left.min()},Ki.prototype.ct=function(){return this.min().key},Ki.prototype.at=function(){return this.right.m()?this.key:this.right.at()},Ki.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).yt()},Ki.prototype.Pt=function(){if(this.left.m())return Ki.EMPTY;var t=this;return t.left.gt()||t.left.left.gt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).yt()},Ki.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.gt()||r.left.left.gt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.gt()&&(r=r.vt()),r.right.m()||r.right.gt()||r.right.left.gt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return Ki.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.yt()},Ki.prototype.gt=function(){return this.color},Ki.prototype.yt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.St()),t.left.gt()&&t.left.left.gt()&&(t=t.vt()),t.left.gt()&&t.right.gt()&&(t=t.Dt()),t},Ki.prototype.Vt=function(){var t=this.Dt();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.vt())).St()).Dt()),t},Ki.prototype.bt=function(){var t=this.Dt();return t.left.left.gt()&&(t=(t=t.vt()).Dt()),t},Ki.prototype.St=function(){var t=this.copy(null,null,Ki.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ki.prototype.vt=function(){var t=this.copy(null,null,Ki.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ki.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ki.prototype.Ct=function(){var t=this.Ft();return Math.pow(2,t)<=this.size+1},Ki.prototype.Ft=function(){if(this.gt()&&this.left.gt())throw Vr();if(this.right.gt())throw Vr();var t=this.left.Ft();if(t!==this.right.Ft())throw Vr();return t+(this.gt()?0:1)},Ki);function Ki(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ki.RED,this.left=null!=r?r:Ki.EMPTY,this.right=null!=i?i:Ki.EMPTY,this.size=this.left.size+1+this.right.size}function Yi(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}function Ji(t,e){this.i=t,this.root=e||Xi.EMPTY}function $i(){this.size=0}Xi.EMPTY=null,Xi.RED=!0,Xi.ut=!1,Xi.EMPTY=(Object.defineProperty($i.prototype,"key",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"value",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"color",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"left",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"right",{get:function(){throw Vr()},enumerable:!1,configurable:!0}),$i.prototype.copy=function(t,e,n,r,i){return this},$i.prototype.ot=function(t,e,n){return new Xi(t,e)},$i.prototype.remove=function(t,e){return this},$i.prototype.m=function(){return!0},$i.prototype.ht=function(t){return!1},$i.prototype.lt=function(t){return!1},$i.prototype.ct=function(){return null},$i.prototype.at=function(){return null},$i.prototype.gt=function(){return!1},$i.prototype.Ct=function(){return!0},$i.prototype.Ft=function(){return 0},new $i);var Zi=(ro.prototype.has=function(t){return null!==this.data.get(t)},ro.prototype.first=function(){return this.data.ct()},ro.prototype.last=function(){return this.data.at()},Object.defineProperty(ro.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ro.prototype.indexOf=function(t){return this.data.indexOf(t)},ro.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},ro.prototype.Nt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.i(r.key,t[1]))return;e(r.key)}},ro.prototype.$t=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},ro.prototype.xt=function(t){t=this.data.ft(t);return t.At()?t.It().key:null},ro.prototype._t=function(){return new to(this.data._t())},ro.prototype.ft=function(t){return new to(this.data.ft(t))},ro.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},ro.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ro.prototype.m=function(){return this.data.m()},ro.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ro.prototype.isEqual=function(t){if(!(t instanceof ro))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.i(r,i))return!1}return!0},ro.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ro.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ro.prototype.copy=function(t){var e=new ro(this.i);return e.data=t,e},ro),to=(no.prototype.It=function(){return this.Ot.It().key},no.prototype.At=function(){return this.Ot.At()},no),eo=new Qi(qr.i);function no(t){this.Ot=t}function ro(t){this.i=t,this.data=new Qi(this.i)}var io=new Qi(qr.i);var oo=new Qi(qr.i),so=new Zi(qr.i);function uo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=so,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ao=new Zi(pi);var ho=(Ro.qt=function(t){return new Ro(t.i)},Ro.prototype.has=function(t){return null!=this.Lt.get(t)},Ro.prototype.get=function(t){return this.Lt.get(t)},Ro.prototype.first=function(){return this.Mt.ct()},Ro.prototype.last=function(){return this.Mt.at()},Ro.prototype.m=function(){return this.Mt.m()},Ro.prototype.indexOf=function(t){t=this.Lt.get(t);return t?this.Mt.indexOf(t):-1},Object.defineProperty(Ro.prototype,"size",{get:function(){return this.Mt.size},enumerable:!1,configurable:!0}),Ro.prototype.forEach=function(n){this.Mt.ht(function(t,e){return n(t),!1})},Ro.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Lt.ot(t.key,t),e.Mt.ot(t,null))},Ro.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Lt.remove(t),this.Mt.remove(e)):this},Ro.prototype.isEqual=function(t){if(!(t instanceof Ro))return!1;if(this.size!==t.size)return!1;for(var e=this.Mt._t(),n=t.Mt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},Ro.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ro.prototype.copy=function(t,e){var n=new Ro;return n.i=this.i,n.Lt=t,n.Mt=e,n},Ro),co=(No.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.ot(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.ot(e,{type:2,doc:t.doc}):Vr()},No.prototype.Bt=function(){var n=[];return this.Ut.ht(function(t,e){n.push(e)}),n},No),lo=(Ao.zt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ao(t,e,ho.qt(e),i,n,r,!0,!1)},Object.defineProperty(Ao.prototype,"hasPendingWrites",{get:function(){return!this.jt.m()},enumerable:!1,configurable:!0}),Ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.jt.isEqual(t.jt)&&Du(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Qt.isEqual(t.Qt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ao),fo=(To.Xt=function(t,e){var n=new Map;return n.set(t,po.Zt(t,e)),new To(Oi.min(),n,ao,eo,uo())},To),po=(Io.Zt=function(t,e){return new Io(yi.q,e,uo(),uo(),uo())},Io),yo=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},vo=function(t,e){this.targetId=t,this.oe=e},go=function(t,e,n,r){void 0===n&&(n=yi.q),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},mo=(Object.defineProperty(Eo.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(Eo.prototype,"resumeToken",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Eo.prototype,"_e",{get:function(){return 0!==this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(Eo.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),Eo.prototype.de=function(t){0<t.L()&&(this.le=!0,this.ae=t)},Eo.prototype.we=function(){var n=uo(),r=uo(),i=uo();return this.ce.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Vr()}}),new po(this.ae,this.he,n,r,i)},Eo.prototype.me=function(){this.le=!1,this.ce=So()},Eo.prototype.Te=function(t,e){this.le=!0,this.ce=this.ce.ot(t,e)},Eo.prototype.Ee=function(t){this.le=!0,this.ce=this.ce.remove(t)},Eo.prototype.Ie=function(){this.ue+=1},Eo.prototype.Ae=function(){--this.ue},Eo.prototype.Re=function(){this.le=!0,this.he=!0},Eo),wo=(bo.prototype.ve=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof lu?this.be(r,t.re):t.re instanceof fu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},bo.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Fe(t);switch(n.state){case 0:r.Ne(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.me(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.Ne(t)&&(r.$e(t),e.de(n.resumeToken));break;default:Vr()}})},bo.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},bo.prototype.xe=function(t){var e=t.targetId,n=t.oe.count,t=this.ke(e);t&&(xi(t=t.target)?0===n?(t=new qr(t.path),this.Se(e,t,new fu(t,Oi.min()))):_r(1===n):this.Oe(e)!==n&&(this.$e(e),this.Ve=this.Ve.add(e)))},bo.prototype.Le=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.ke(e);n&&(t.te&&xi(n.target)&&(n=new qr(n.target.path),null!==i.ge.get(n)||i.Me(e,n)||i.Se(e,n,new fu(n,r))),t.fe&&(o.set(e,t.we()),t.me()))});var s=uo();this.pe.forEach(function(t,e){var n=!0;e.$t(function(t){t=i.ke(t);return!t||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new fo(r,o,this.Ve,this.ge,s);return this.ge=eo,this.pe=Oo(),this.Ve=new Zi(pi),t},bo.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Me(t,e.key)?2:0,this.Fe(t).Te(e.key,n),this.ge=this.ge.ot(e.key,e),this.pe=this.pe.ot(e.key,this.qe(e.key).add(t)))},bo.prototype.Se=function(t,e,n){var r;this.Ne(t)&&(r=this.Fe(t),this.Me(t,e)?r.Te(e,1):r.Ee(e),this.pe=this.pe.ot(e,this.qe(e).delete(t)),n&&(this.ge=this.ge.ot(e,n)))},bo.prototype.removeTarget=function(t){this.Pe.delete(t)},bo.prototype.Oe=function(t){var e=this.Fe(t).we();return this.ye.Ue(t).size+e.ee.size-e.se.size},bo.prototype.Ie=function(t){this.Fe(t).Ie()},bo.prototype.Fe=function(t){var e=this.Pe.get(t);return e||(e=new mo,this.Pe.set(t,e)),e},bo.prototype.qe=function(t){var e=this.pe.get(t);return e||(e=new Zi(pi),this.pe=this.pe.ot(t,e)),e},bo.prototype.Ne=function(t){var e=null!==this.ke(t);return e||Or("WatchChangeAggregator","Detected inactive target",t),e},bo.prototype.ke=function(t){var e=this.Pe.get(t);return e&&e._e?null:this.ye.Be(t)},bo.prototype.$e=function(e){var n=this;this.Pe.set(e,new mo),this.ye.Ue(e).forEach(function(t){n.Se(e,t,null)})},bo.prototype.Me=function(t,e){return this.ye.Ue(t).has(e)},bo);function bo(t){this.ye=t,this.Pe=new Map,this.ge=eo,this.pe=Oo(),this.Ve=new Zi(pi)}function Eo(){this.ue=0,this.ce=So(),this.ae=yi.q,this.he=!1,this.le=!0}function Io(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function To(t,e,n,r,i){this.nt=t,this.Kt=e,this.Ht=n,this.Yt=r,this.Jt=i}function Ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Qt=n,this.docChanges=r,this.jt=i,this.fromCache=o,this.Wt=s,this.Gt=u}function No(){this.Ut=new Qi(qr.i)}function Ro(n){this.i=n?function(t,e){return n(t,e)||qr.i(t.key,e.key)}:function(t,e){return qr.i(t.key,e.key)},this.Lt=io,this.Mt=new Qi(this.i)}function Oo(){return new Qi(qr.i)}function So(){return new Qi(qr.i)}function Do(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Lo(t){t=Mo(t.mapValue.fields.__local_write_time__.timestampValue);return new Ri(t.seconds,t.nanos)}var Vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _o(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Do(t)?4:10:Vr()}function Uo(r,i){var t,e=_o(r);if(e!==_o(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Lo(r).isEqual(Lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Mo(r.timestampValue),t=Mo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Fo(r.bytesValue).isEqual(Fo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,xo((t=r).geoPointValue.latitude)===xo(e.geoPointValue.latitude)&&xo(t.geoPointValue.longitude)===xo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return xo(t.integerValue)===xo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=xo(t.doubleValue),e=xo(e.doubleValue);return t===e?ki(t)===ki(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return di(r.arrayValue.values||[],i.arrayValue.values||[],Uo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ur(e)!==Ur(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Uo(e[t],n[t])))return!1;return!0}();default:return Vr()}}function ko(t,e){return void 0!==(t.values||[]).find(function(t){return Uo(t,e)})}function jo(t,e){var n,r,i=_o(t),o=_o(e);if(i!==o)return pi(i,o);switch(i){case 0:return 0;case 1:return pi(t.booleanValue,e.booleanValue);case 2:return n=e,r=xo(t.integerValue||t.doubleValue),n=xo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Po(t.timestampValue,e.timestampValue);case 4:return Po(Lo(t),Lo(e));case 5:return pi(t.stringValue,e.stringValue);case 6:return function(t,e){t=Fo(t),e=Fo(e);return t.M(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=pi(n[i],r[i]);if(0!==o)return o}return pi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=pi(xo(i.latitude),xo(r.latitude)))?n:pi(xo(i.longitude),xo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=jo(n[i],r[i]);if(o)return o}return pi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=pi(r[s],o[s]);if(0!==u)return u;u=jo(n[r[s]],i[o[s]]);if(0!==u)return u}return pi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Vr()}}function Po(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return pi(t,e);var n=Mo(t),t=Mo(e),e=pi(n.seconds,t.seconds);return 0!==e?e:pi(n.nanos,t.nanos)}function Co(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Mo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Fo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,qr.C(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Vr();var e}(t)}function Mo(t){if(_r(!!t),"string"!=typeof t)return{seconds:xo(t.seconds),nanos:xo(t.nanos)};var e=0,n=Vo.exec(t);_r(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function xo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Fo(t){return"string"==typeof t?yi.fromBase64String(t):yi.fromUint8Array(t)}function qo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Bo(t){return t&&"integerValue"in t}function Go(t){return!!t&&"arrayValue"in t}function zo(t){return t&&"nullValue"in t}function Wo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Qo(t){return t&&"mapValue"in t}var Ho={asc:"ASCENDING",desc:"DESCENDING"},Xo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ko=function(t,e){this.B=t,this.Qe=e};function Yo(t){return{integerValue:""+t}}function Jo(t,e){if(t.Qe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ki(e)?"-0":e}}function $o(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!ki(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Yo(e):Jo(t,e);var n}function Zo(t,e){return t.Qe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ts(t,e){return t.Qe?e.toBase64():e.toUint8Array()}function es(t){return _r(!!t),Oi.J((t=Mo(t),new Ri(t.seconds,t.nanos)))}function ns(t,e){return new Mr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function rs(t,e){return ns(t.B,e.path)}function is(t,e){_r(fs(e=Mr.P(e)));return _r(e.get(1)===t.B.projectId),_r(!e.get(3)&&!t.B.database||e.get(3)===t.B.database),new qr((_r(4<(e=e).length&&"documents"===e.get(4)),e.u(5)))}function os(t,e){return ns(t.B,e)}function ss(t){return new Mr(["projects",t.B.projectId,"databases",t.B.database]).R()}function us(t,e,n){return{name:rs(t,e),fields:n.proto.mapValue.fields}}function as(t,e){var n,r,i;if(e instanceof Gs)n={update:us(t,e.key,e.value)};else if(e instanceof tu)n={delete:rs(t,e.key)};else if(e instanceof zs)n={update:us(t,e.key,e.data),updateMask:(i=e.je,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof Ks)n={transform:{document:rs(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof vs)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof gs)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Is)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Rs)return{fieldPath:t.field.R(),increment:e.We};throw Vr()})}};else{if(!(e instanceof eu))return Vr();n={verify:rs(t,e.key)}}return e.ze.Ge||(n.currentDocument=void 0!==(i=e.ze).updateTime?{updateTime:(e=t,t=i.updateTime,Zo(e,t.Z()))}:void 0!==i.exists?{exists:i.exists}:Vr()),n}function hs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=os(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=os(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Wo(t.value))return{unaryFilter:{field:ls(t.field),op:"IS_NAN"}};if(zo(t.value))return{unaryFilter:{field:ls(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Wo(t.value))return{unaryFilter:{field:ls(t.field),op:"IS_NOT_NAN"}};if(zo(t.value))return{unaryFilter:{field:ls(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ls(t.field),op:(e=t.op,Xo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:ls((t=t).field),direction:(t=t.dir,Ho[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Qe||Ui(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=cs(e.startAt)),e.endAt&&(n.structuredQuery.endAt=cs(e.endAt)),n}function cs(t){return{before:t.before,values:t.position}}function ls(t){return{fieldPath:t.R()}}function fs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}l=function(){this.Ke=void 0};function ps(t,e){return t instanceof Rs?Bo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ds,ys,vs=(n(ws,ys=l),ws),gs=(n(ms,ds=l),ms);function ms(t){var e=this;return(e=ds.call(this)||this).elements=t,e}function ws(){return null!==ys&&ys.apply(this,arguments)||this}function bs(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Uo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Es,Is=(n(Ts,Es=l),Ts);function Ts(t){var e=this;return(e=Es.call(this)||this).elements=t,e}function As(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Uo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ns,Rs=(n(Os,Ns=l),Os);function Os(t,e){var n=this;return(n=Ns.call(this)||this).serializer=t,n.We=e,n}function Ss(t){return xo(t.integerValue||t.doubleValue)}function Ds(t){return Go(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ls(t,e){this.field=t,this.transform=e}var Vs=(_s.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},_s.prototype.isEqual=function(t){return di(this.fields,t.fields,function(t,e){return t.isEqual(e)})},_s);function _s(t){(this.fields=t).sort(Fr.i)}function Us(t,e){this.version=t,this.transformResults=e}var ks=(js.Ye=function(){return new js},js.exists=function(t){return new js(void 0,t)},js.updateTime=function(t){return new js(t)},Object.defineProperty(js.prototype,"Ge",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),js.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},js);function js(t,e){this.updateTime=t,this.exists=e}function Ps(t,e){return void 0!==t.updateTime?e instanceof lu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof lu}l=function(){};function Cs(t,e,n){return t instanceof Gs?new lu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof zs?function(t,e,n){if(!Ps(t.ze,e))return new pu(t.key,n.version);e=Hs(t,e);return new lu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Ks?function(t,e,n){if(_r(null!=n.transformResults),!Ps(t.ze,e))return new pu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];_r(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof lu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof gs?bs(o,s):o instanceof Is?As(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Js(t,r.data(),e);return new lu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new fu(t.key,n.version,{hasCommittedMutations:!0})}function Ms(t,e,n,r){return t instanceof Gs?function(t,e){if(!Ps(t.ze,e))return e;e=Fs(e);return new lu(t.key,e,t.value,{Je:!0})}(t,e):t instanceof zs?function(t,e){if(!Ps(t.ze,e))return e;var n=Fs(e),e=Hs(t,e);return new lu(t.key,n,e,{Je:!0})}(t,e):t instanceof Ks?function(t,e,n,r){if(!Ps(t.ze,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof lu&&(c=n.field(a.field)),null===c&&r instanceof lu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof vs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof gs?bs(h,i):h instanceof Is?As(h,i):(h=ps(c=h,i),i=Ss(h)+Ss(c.We),Bo(h)&&Bo(c.We)?Yo(i):Jo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Js(t,i.data(),r);return new lu(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Ps((t=t).ze,e)?new fu(t.key,Oi.min()):e)}function xs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.ze.isEqual(e.ze)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.je.isEqual(e.je):2!==t.type||di(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof gs&&e instanceof gs||t instanceof Is&&e instanceof Is?di(t.elements,e.elements,Uo):t instanceof Rs&&e instanceof Rs?Uo(t.We,e.We):t instanceof vs&&e instanceof vs)}))}function Fs(t){return t instanceof lu?t.version:Oi.min()}var qs,Bs,Gs=(n(Qs,Bs=l),Qs),zs=(n(Ws,qs=l),Ws);function Ws(t,e,n,r){var i=this;return(i=qs.call(this)||this).key=t,i.data=e,i.je=n,i.ze=r,i.type=1,i}function Qs(t,e,n){var r=this;return(r=Bs.call(this)||this).key=t,r.value=e,r.ze=n,r.type=0,r}function Hs(t,e){return n=t,e=e instanceof lu?e.data():nu.empty(),r=new ru(e),n.je.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var Xs,Ks=(n(Ys,Xs=l),Ys);function Ys(t,e){var n=this;return(n=Xs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.ze=ks.exists(!0),n}function Js(t,e,n){for(var r=new ru(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var $s,Zs,tu=(n(uu,Zs=l),uu),eu=(n(su,$s=l),su),nu=(ou.empty=function(){return new ou({mapValue:{}})},ou.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Qo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},ou.prototype.isEqual=function(t){return Uo(this.proto,t.proto)},ou),ru=(iu.prototype.set=function(t,e){return this.en(t,e),this},iu.prototype.delete=function(t){return this.en(t,null),this},iu.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===_o(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},iu.prototype.Xe=function(){var t=this.nn(Fr.g(),this.tn);return null!=t?new nu(t):this.Ze},iu.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=Qo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},iu);function iu(t){void 0===t&&(t=nu.empty()),this.Ze=t,this.tn=new Map}function ou(t){this.proto=t}function su(t,e){var n=this;return(n=$s.call(this)||this).key=t,n.ze=e,n.type=4,n}function uu(t,e){var n=this;return(n=Zs.call(this)||this).key=t,n.ze=e,n.type=3,n}var au,hu,cu,l=function(t,e){this.key=t,this.version=e},lu=(n(gu,cu=l),gu.prototype.field=function(t){return this.sn.field(t)},gu.prototype.data=function(){return this.sn},gu.prototype.rn=function(){return this.sn.proto},gu.prototype.isEqual=function(t){return t instanceof gu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},gu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(gu.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),gu),fu=(n(vu,hu=l),vu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(vu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),vu.prototype.isEqual=function(t){return t instanceof vu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},vu),pu=(n(yu,au=l),yu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(yu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),yu.prototype.isEqual=function(t){return t instanceof yu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},yu),du=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.un=o,this.startAt=s,this.endAt=u,this.cn=null,this.an=null,this.startAt,this.endAt};function yu(){return null!==au&&au.apply(this,arguments)||this}function vu(t,e,n){var r=this;return(r=hu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function gu(t,e,n,r){var i=this;return(i=cu.call(this,t,e)||this).sn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function mu(t){return new du(t)}function wu(t){return!Ui(t.limit)&&"F"===t.un}function bu(t){return!Ui(t.limit)&&"L"===t.un}function Eu(t){return 0<t.on.length?t.on[0].field:null}function Iu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.hn())return r.field}return null}function Tu(t){return null!==t.collectionGroup}function Au(t){var e=t;if(null===e.cn){e.cn=[];var n=Iu(e),t=Eu(e);if(null!==n&&null===t)n.V()||e.cn.push(new ha(n)),e.cn.push(new ha(Fr.v(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.cn.push(s),s.field.V()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.cn.push(new ha(Fr.v(),n)))}}return e.cn}function Nu(t){var e=t;if(!e.an)if("F"===e.un)e.an=Pi(e.path,e.collectionGroup,Au(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Au(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ha(o.field,s))}var u=e.endAt?new ea(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ea(e.startAt.position,!e.startAt.before):null;e.an=Pi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function Ru(t,e,n){return new du(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ou(t,e){return new du(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.un,e,t.endAt)}function Su(t,e){return new du(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.un,t.startAt,e)}function Du(t,e){return Mi(Nu(t),Nu(e))&&t.un===e.un}function Lu(t){return Ci(Nu(t))+"|lt:"+t.un}function Vu(t){return"Query(target="+(e=Nu(t),n=e.path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Co(t.value)}).join(", ")+"]"),Ui(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+sa(e.startAt)),e.endAt&&(n+=", endAt: "+sa(e.endAt)),"Target("+n+")")+"; limitType="+t.un+")";var e,n}function _u(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.F(e.collectionGroup)&&e.path.T(n):qr.N(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.V()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ua(t.startAt,Au(t),n))&&(!t.endAt||!ua(t.endAt,Au(t),n)));var e,n}function Uu(u){return function(t,e){for(var n=!1,r=0,i=Au(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.V()?qr.i(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?jo(n,t):Vr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Vr()}}(o,t,e);if(0!==s)return s;n=n||o.field.V()}return 0}}var ku,ju=(n(Pu,ku=function(){}),Pu.create=function(t,e,n){if(t.V())return"in"===e||"not-in"===e?this.ln(t,e,n):new Fu(t,e,n);if(zo(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Pu(t,e,n)}if(Wo(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Pu(t,e,n)}return"array-contains"===e?new Ju(t,n):"in"===e?new $u(t,n):"not-in"===e?new Zu(t,n):"array-contains-any"===e?new ta(t,n):new Pu(t,e,n)},Pu.ln=function(t,e,n){return new("in"===e?qu:Bu)(t,n)},Pu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this._n(jo(t,this.value)):null!==t&&_o(this.value)===_o(t)&&this._n(jo(t,this.value))},Pu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Vr()}},Pu.prototype.hn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Pu);function Pu(t,e,n){var r=this;return(r=ku.call(this)||this).field=t,r.op=e,r.value=n,r}var Cu,Mu,xu,Fu=(n(Wu,xu=ju),Wu.prototype.matches=function(t){t=qr.i(t.key,this.key);return this._n(t)},Wu),qu=(n(zu,Mu=ju),zu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},zu),Bu=(n(Gu,Cu=ju),Gu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Gu);function Gu(t,e){var n=this;return(n=Cu.call(this,t,"not-in",e)||this).keys=Qu(0,e),n}function zu(t,e){var n=this;return(n=Mu.call(this,t,"in",e)||this).keys=Qu(0,e),n}function Wu(t,e,n){var r=this;return(r=xu.call(this,t,e,n)||this).key=qr.C(n.referenceValue),r}function Qu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return qr.C(t.referenceValue)})}var Hu,Xu,Ku,Yu,Ju=(n(oa,Yu=ju),oa.prototype.matches=function(t){t=t.field(this.field);return Go(t)&&ko(t.arrayValue,this.value)},oa),$u=(n(ia,Ku=ju),ia.prototype.matches=function(t){t=t.field(this.field);return null!==t&&ko(this.value.arrayValue,t)},ia),Zu=(n(ra,Xu=ju),ra.prototype.matches=function(t){if(ko(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!ko(this.value.arrayValue,t)},ra),ta=(n(na,Hu=ju),na.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Go(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return ko(e.value.arrayValue,t)})},na),ea=function(t,e){this.position=t,this.before=e};function na(t,e){return Hu.call(this,t,"array-contains-any",e)||this}function ra(t,e){return Xu.call(this,t,"not-in",e)||this}function ia(t,e){return Ku.call(this,t,"in",e)||this}function oa(t,e){return Yu.call(this,t,"array-contains",e)||this}function sa(t){return(t.before?"b":"a")+":"+t.position.map(Co).join(",")}function ua(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.V()?qr.i(qr.C(s.referenceValue),n.key):jo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function aa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Uo(t.position[n],e.position[n]))return!1;return!0}var ha=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ca(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var la=(da.prototype.reset=function(){this.En=0},da.prototype.Rn=function(){this.En=this.Tn},da.prototype.yn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.Pn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.gn(this.dn,i,function(){return e.An=Date.now(),t()}),this.En*=this.mn,this.En<this.wn&&(this.En=this.wn),this.En>this.Tn&&(this.En=this.Tn)},da.prototype.pn=function(){null!==this.In&&(this.In.Vn(),this.In=null)},da.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},da.prototype.Pn=function(){return(Math.random()-.5)*this.En},da),fa=(pa.prototype.catch=function(t){return this.next(void 0,t)},pa.prototype.next=function(r,i){var o=this;return this.Dn&&Vr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Fn(r,this.result):new pa(function(e,n){o.vn=function(t){o.Fn(r,t).next(e,n)},o.bn=function(t){o.Cn(i,t).next(e,n)}})},pa.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},pa.prototype.$n=function(t){try{var e=t();return e instanceof pa?e:pa.resolve(e)}catch(t){return pa.reject(t)}},pa.prototype.Fn=function(t,e){return t?this.$n(function(){return t(e)}):pa.resolve(e)},pa.prototype.Cn=function(t,e){return t?this.$n(function(){return t(e)}):pa.reject(e)},pa.resolve=function(n){return new pa(function(t,e){t(n)})},pa.reject=function(n){return new pa(function(t,e){e(n)})},pa.xn=function(t){return new pa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},pa.kn=function(t){for(var n=pa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?pa.resolve(t):e()})}(r[e]);return n},pa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.xn(i)},pa);function pa(t){var e=this;this.vn=null,this.bn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.vn&&e.vn(t)},function(t){e.Sn=!0,e.error=t,e.bn&&e.bn(t)})}function da(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.mn=r,this.Tn=i,this.En=0,this.In=null,this.An=Date.now(),this.reset()}function ya(t){return"IndexedDbTransactionError"===t.name}function va(){return"undefined"!=typeof document?document:null}var ga=(ba.Un=function(t,e,n,r,i){i=new ba(t,e,Date.now()+n,r,i);return i.start(n),i},ba.prototype.start=function(t){var e=this;this.Bn=setTimeout(function(){return e.Qn()},t)},ba.prototype.Vn=function(){return this.Qn()},ba.prototype.cancel=function(t){null!==this.Bn&&(this.clearTimeout(),this.qn.reject(new Tr(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ba.prototype.Qn=function(){var e=this;this.On.jn(function(){return null!==e.Bn?(e.clearTimeout(),e.op().then(function(t){return e.qn.resolve(t)})):Promise.resolve()})},ba.prototype.clearTimeout=function(){null!==this.Bn&&(this.Mn(this),clearTimeout(this.Bn),this.Bn=null)},ba),ma=(Object.defineProperty(wa.prototype,"ts",{get:function(){return this.zn},enumerable:!1,configurable:!0}),wa.prototype.jn=function(t){this.enqueue(t)},wa.prototype.es=function(t){this.ns(),this.ss(t)},wa.prototype.rs=function(){var t;this.zn||(this.zn=!0,(t=va())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Zn))},wa.prototype.enqueue=function(t){return this.ns(),this.zn?new Promise(function(t){}):this.ss(t)},wa.prototype.os=function(t){var e=this;this.jn(function(){return e.Gn.push(t),e.us()})},wa.prototype.us=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Gn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Gn[0]()];case 2:return t.sent(),this.Gn.shift(),this.Xn.reset(),[3,4];case 3:if(!ya(e=t.sent()))throw e;return Or("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Gn.length&&this.Xn.yn(function(){return n.us()}),t.label=5;case 5:return[2]}})})},wa.prototype.ss=function(t){var r=this,e=this.Wn.then(function(){return r.Yn=!0,t().catch(function(t){throw r.Hn=t,r.Yn=!1,Sr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Yn=!1,t})});return this.Wn=e},wa.prototype.gn=function(t,e,n){var r=this;this.ns(),-1<this.Jn.indexOf(t)&&(e=0);n=ga.Un(this,t,e,n,function(t){return r.cs(t)});return this.Kn.push(n),n},wa.prototype.ns=function(){this.Hn&&Vr()},wa.prototype.hs=function(){},wa.prototype.ls=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Wn];case 1:t.sent(),t.label=2;case 2:if(e!==this.Wn)return[3,0];t.label=3;case 3:return[2]}})})},wa.prototype._s=function(t){for(var e=0,n=this.Kn;e<n.length;e++)if(n[e].dn===t)return!0;return!1},wa.prototype.fs=function(r){var i=this;return this.ls().then(function(){i.Kn.sort(function(t,e){return t.Ln-e.Ln});for(var t=0,e=i.Kn;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n.dn===r)break}return i.ls()})},wa.prototype.ds=function(t){this.Jn.push(t)},wa.prototype.cs=function(t){t=this.Kn.indexOf(t);this.Kn.splice(t,1)},wa);function wa(){var e=this;this.Wn=Promise.resolve(),this.Gn=[],this.zn=!1,this.Kn=[],this.Hn=null,this.Yn=!1,this.Jn=[],this.Xn=new la(this,"async_queue_retry"),this.Zn=function(){var t=va();t&&Or("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Xn.pn()};var t=va();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Zn)}function ba(t,e,n,r,i){this.On=t,this.dn=e,this.Ln=n,this.op=r,this.Mn=i,this.qn=new ca,this.then=this.qn.promise.then.bind(this.qn.promise),this.qn.promise.catch(function(t){})}function Ea(t,e){if(Sr("AsyncQueue",e+": "+t),ya(t))return new Tr(Ir.UNAVAILABLE,e+": "+t);throw t}function Ia(){this.ws=void 0,this.listeners=[]}function Ta(){this.Ts=new Ni(Lu,Du),this.onlineState="Unknown",this.Es=new Set}function Aa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Ts.get(n))||(r=!0,i=new Ia),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Is(n)];case 2:return o.ws=t.sent(),[3,4];case 3:return o=t.sent(),o=Ea(o,"Initialization of query '"+Vu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Ts.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ws&&u.Rs(i.ws)&&Ra(e),[2]}})})}function Na(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Ts.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Ts.delete(n),e.ys(n))]:[2]})})}function Ra(t){t.Es.forEach(function(t){t.next()})}var Oa=(La.prototype.Rs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new lo(t.query,t.docs,t.Qt,e,t.jt,t.fromCache,t.Wt,!0)}var o=!1;return this.gs?this.Vs(t)&&(this.Ps.next(t),o=!0):this.vs(t,this.onlineState)&&(this.bs(t),o=!0),this.ps=t,o},La.prototype.onError=function(t){this.Ps.error(t)},La.prototype.As=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.gs&&this.vs(this.ps,t)&&(this.bs(this.ps),e=!0),e},La.prototype.vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ss&&n||t.docs.m()&&"Offline"!==e)},La.prototype.Vs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},La.prototype.bs=function(t){t=lo.zt(t.query,t.docs,t.jt,t.fromCache),this.gs=!0,this.Ps.next(t)},La),Sa=(Da.prototype.Ds=function(){return null!=this.uid},Da.prototype.Cs=function(){return this.Ds()?"uid:"+this.uid:"anonymous-user"},Da.prototype.isEqual=function(t){return t.uid===this.uid},Da);function Da(t){this.uid=t}function La(t,e,n){this.query=t,this.Ps=e,this.gs=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}Sa.UNAUTHENTICATED=new Sa(null),Sa.Fs=new Sa("google-credentials-uid"),Sa.Ns=new Sa("first-party-uid");var Va=(_a.prototype.xs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},_a.prototype.next=function(){var t=++this.previousValue;return this.ks&&this.ks(t),t},_a);function _a(t,e){var n=this;this.previousValue=t,e&&(e.$s=function(t){return n.xs(t)},this.ks=function(t){return e.Os(t)})}Va.Ls=-1;var Ua=(Qa.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Qa.prototype.qs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Qa.prototype.Us=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Qa),ka=(Wa.prototype.Ws=function(t){},Wa.prototype.Gs=function(t,e,n){},Wa.prototype.zs=function(t){return this.Bs.Ms(t),this.Qs[t]||"not-current"},Wa.prototype.Ks=function(t,e,n){this.Qs[t]=e},Wa.prototype.Hs=function(t){this.Bs.qs(t)},Wa.prototype.Ys=function(t){return this.Bs.activeTargetIds.has(t)},Wa.prototype.Js=function(t){delete this.Qs[t]},Wa.prototype.Xs=function(){return this.Bs.activeTargetIds},Wa.prototype.Zs=function(t){return this.Bs.activeTargetIds.has(t)},Wa.prototype.start=function(){return this.Bs=new Ua,Promise.resolve()},Wa.prototype.ti=function(t,e,n){},Wa.prototype.ei=function(t){},Wa.prototype.ni=function(){},Wa.prototype.Os=function(t){},Wa),ja=(za.prototype.ii=function(t,e,n){for(var r=n.ri,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Cs(o,e,r[i]))}return e},za.prototype.oi=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ms(i,e,e,this.si))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ms(a,e,o,this.si))}return e},za.prototype.ui=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.oi(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},za.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},uo())},za.prototype.isEqual=function(t){return this.batchId===t.batchId&&di(this.mutations,t.mutations,xs)&&di(this.baseMutations,t.baseMutations,xs)},za),Pa=(Ga.from=function(t,e,n){_r(t.mutations.length===n.length);for(var r=oo,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new Ga(t,e,n,r)},Ga),Ca=(Ba.prototype.fi=function(e,n){var r=this;return this.li.di(e,n).next(function(t){return r.wi(e,n,t)})},Ba.prototype.wi=function(t,r,i){return this.hi.mi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].oi(r,t);return t})},Ba.prototype.Ti=function(t,e,i){var o=eo;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].oi(t,e);o=o.ot(t,e)}),o},Ba.prototype.Ei=function(e,t){var n=this;return this.hi.getEntries(e,t).next(function(t){return n.Ii(e,t)})},Ba.prototype.Ii=function(e,r){var i=this;return this.li.Ai(e,r).next(function(t){var t=i.Ti(e,r,t),n=eo;return t.forEach(function(t,e){e=e||new fu(t,Oi.min()),n=n.ot(t,e)}),n})},Ba.prototype.Ri=function(t,e,n){return r=e,qr.N(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.yi(t,e.path):Tu(e)?this.Pi(t,e,n):this.gi(t,e,n);var r},Ba.prototype.yi=function(t,e){return this.fi(t,new qr(e)).next(function(t){var e=io;return t instanceof lu&&(e=e.ot(t.key,t)),e})},Ba.prototype.Pi=function(n,r,i){var o=this,s=r.collectionGroup,u=io;return this._i.pi(n,s).next(function(t){return fa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new du(t,null,e.on.slice(),e.filters.slice(),e.limit,e.un,e.startAt,e.endAt));return o.gi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},Ba.prototype.gi=function(e,n,t){var h,c,r=this;return this.hi.Ri(e,n,t).next(function(t){return h=t,r.li.Vi(e,n)}).next(function(t){return c=t,r.vi(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=Ms(s,a,a,r.si);h=a instanceof lu?h.ot(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){_u(n,e)||(h=h.remove(t))}),h})},Ba.prototype.vi=function(t,e,n){for(var r=uo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof zs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.hi.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof lu&&(h=h.ot(t,e))}),h})},Ba),Ma=(qa.Di=function(t,e){for(var n=uo(),r=uo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new qa(t,e.fromCache,n,r)},qa),xa=(Fa.$i=function(t){return new Fa(t,Fa.xi,Fa.ki)},Fa);function Fa(t,e,n){this.Ci=t,this.Fi=e,this.Ni=n}function qa(t,e,n,r){this.targetId=t,this.fromCache=e,this.bi=n,this.Si=r}function Ba(t,e,n){this.hi=t,this.li=e,this._i=n}function Ga(t,e,n,r){this.batch=t,this.ci=e,this.ri=n,this.ai=r}function za(t,e,n,r){this.batchId=t,this.si=e,this.baseMutations=n,this.mutations=r}function Wa(){this.Bs=new Ua,this.Qs={},this.js=null,this.$s=null}function Qa(){this.activeTargetIds=ao}xa.Oi=-1,xa.Li=1048576,xa.Mi=41943040,xa.xi=10,xa.ki=1e3,xa.qi=new xa(xa.Mi,xa.xi,xa.ki),xa.Ui=new xa(xa.Oi,0,0);var Ha=(th.prototype.Qi=function(t,e){return this.Bi.add(e),fa.resolve()},th.prototype.pi=function(t,e){return fa.resolve(this.Bi.getEntries(e))},th),Xa=(Za.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new Zi(Mr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Za.prototype.has=function(t){var e=t._(),t=t.h(),e=this.index[e];return e&&e.has(t)},Za.prototype.getEntries=function(t){return(this.index[t]||new Zi(Mr.i)).A()},Za),Ka=($a.prototype.next=function(){return this.ji+=2,this.ji},$a.Wi=function(){return new $a(0)},$a.Gi=function(){return new $a(-1)},$a),Ya=(Ja.prototype.rr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.ur(t,n.Ki)})},Ja);function Ja(t,e,n){this.persistence=t,this.zi=e,this.Ki=new Qi(pi),this.Hi=new Ni(Ci,Mi),this.Yi=Oi.min(),this.li=t.Ji(n),this.Xi=t.Zi(),this.tr=t.er(),this.nr=new Ca(this.Xi,this.li,this.persistence.sr()),this.zi.ir(this.nr)}function $a(t){this.ji=t}function Za(){this.index={}}function th(){this.Bi=new Xa}function eh(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.Xi.cr({ar:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=fa.resolve(),n.forEach(function(n){u=u.next(function(){return o.mi(r,n)}).next(function(t){var e=t,t=i.ai.get(n);_r(null!==t),(!e||e.version.M(t)<0)&&(e=s.ii(n,e,i))&&o.hr(e,i.ci)})}),u.next(function(){return e.li.lr(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.li._r(t)}).next(function(){return l.nr.Ei(t,a)})})}function nh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.tr.dr(t)})}function rh(t,a){var h=t,c=a.nt,l=h.Ki;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.Xi.cr({ar:!0});l=h.Ki;var u=[];a.Kt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.tr.wr(s,t.se,e).next(function(){return h.tr.mr(s,t.ee,e)})),0<(i=t.resumeToken).L()&&(n=o.it(i,c).st(s.Tr),l=l.ot(e,n),r=o,i=t,_r(0<(o=n).resumeToken.L()),(0===r.resumeToken.L()||3e8<=o.nt.X()-r.nt.X()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(h.tr.Er(s,n))))});var t,o=eo,n=uo();return a.Yt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Yt.forEach(function(t,e){var n=r.get(t);e instanceof fu&&e.version.isEqual(Oi.min())?(i.Ir(t,c),o=o.ot(t,e)):null==n||0<e.version.M(n.version)||0===e.version.M(n.version)&&n.hasPendingWrites?(i.hr(e,c),o=o.ot(t,e)):Or("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Jt.has(t)&&u.push(h.persistence.Rr.Ar(s,t))})})),c.isEqual(Oi.min())||(t=h.tr.dr(s).next(function(t){return h.tr.yr(s,s.Tr,c)}),u.push(t)),fa.xn(u).next(function(){return i.apply(s)}).next(function(){return h.nr.Ii(s,o)})}).then(function(t){return h.Ki=l,t})}function ih(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Ki.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Rr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ya(r=t.sent()))throw r;return Or("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Ki=e.Ki.remove(o),e.Hi.delete(n.target),[2]}})})}function oh(t,o,s){var u=t,a=Oi.min(),h=uo();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Nu(o),(void 0!==(t=(i=t).Hi.get(r))?fa.resolve(i.Ki.get(t)):i.tr.gr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.tr.pr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.zi.Ri(e,o,s?a:Oi.min(),s?h:uo())}).next(function(t){return{documents:t,Vr:h}});var t,n,r,i})}function sh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Or("LocalStore","Unexpectedly lost primary lease"),[2]})})}function uh(t,e){this.user=e,this.type="OAuth",this.Br={},this.Br.Authorization="Bearer "+t}function ah(t,e,n,r,i){var o=this;this.Qo=t,this.jo=e,this.On=n,this.Wo={},this.Go=[],this.zo=new Map,this.Ko=new Set,this.Ho=[],this.Yo=i,this.Yo.Jo(function(t){n.jn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Bh(this)?(Or("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ko.add(4),[4,kh(e)];case 1:return t.sent(),e.Xo.set("Unknown"),e.Ko.delete(4),[4,Uh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Xo=new Eh(n,r)}var hh,ch,lh,fh=(_h.prototype.m=function(){return this.vr.m()},_h.prototype.Cr=function(t,e){e=new ph(t,e);this.vr=this.vr.add(e),this.Sr=this.Sr.add(e)},_h.prototype.Fr=function(t,e){var n=this;t.forEach(function(t){return n.Cr(t,e)})},_h.prototype.Nr=function(t,e){this.$r(new ph(t,e))},_h.prototype.kr=function(t,e){var n=this;t.forEach(function(t){return n.Nr(t,e)})},_h.prototype.Or=function(t){var e=this,n=new qr(new Mr([])),r=new ph(n,t),t=new ph(n,t+1),i=[];return this.Sr.Nt([r,t],function(t){e.$r(t),i.push(t.key)}),i},_h.prototype.Lr=function(){var e=this;this.vr.forEach(function(t){return e.$r(t)})},_h.prototype.$r=function(t){this.vr=this.vr.delete(t),this.Sr=this.Sr.delete(t)},_h.prototype.Mr=function(t){var e=new qr(new Mr([])),n=new ph(e,t),t=new ph(e,t+1),r=uo();return this.Sr.Nt([n,t],function(t){r=r.add(t.key)}),r},_h.prototype.qr=function(t){var e=new ph(t,0),e=this.vr.xt(e);return null!==e&&t.isEqual(e.key)},_h),ph=(Vh.br=function(t,e){return qr.i(t.key,e.key)||pi(t.Ur,e.Ur)},Vh.Dr=function(t,e){return pi(t.Ur,e.Ur)||qr.i(t.key,e.key)},Vh),dh=(Lh.prototype.getToken=function(){return Promise.resolve(null)},Lh.prototype.jr=function(){},Lh.prototype.Wr=function(t){(this.Qr=t)(Sa.UNAUTHENTICATED)},Lh.prototype.Gr=function(){this.Qr=null},Lh),yh=(Dh.prototype.getToken=function(){var e=this,n=this.Hr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Hr!==n?(Or("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(_r("string"==typeof t.accessToken),new uh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Dh.prototype.jr=function(){this.forceRefresh=!0},Dh.prototype.Wr=function(t){this.Qr=t,this.Kr&&t(this.currentUser)},Dh.prototype.Gr=function(){this.auth&&this.auth.removeAuthTokenListener(this.zr),this.zr=null,this.Qr=null},Dh.prototype.Yr=function(){var t=this.auth&&this.auth.getUid();return _r(null===t||"string"==typeof t),new Sa(t)},Dh),vh=(Object.defineProperty(Sh.prototype,"Br",{get:function(){var t={"X-Goog-AuthUser":this.Xr},e=this.Jr.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Sh),gh=(Oh.prototype.getToken=function(){return Promise.resolve(new vh(this.Jr,this.Xr))},Oh.prototype.Wr=function(t){t(Sa.Ns)},Oh.prototype.Gr=function(){},Oh.prototype.jr=function(){},Oh),l=(Rh.prototype.ro=function(){return 1===this.state||2===this.state||4===this.state},Rh.prototype.oo=function(){return 2===this.state},Rh.prototype.start=function(){3!==this.state?this.auth():this.uo()},Rh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Rh.prototype.co=function(){this.state=0,this.Xn.reset()},Rh.prototype.ao=function(){var t=this;this.oo()&&null===this.io&&(this.io=this.fn.gn(this.Zr,6e4,function(){return t.ho()}))},Rh.prototype.lo=function(t){this._o(),this.stream.send(t)},Rh.prototype.ho=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.oo()?[2,this.close(0)]:[2]})})},Rh.prototype._o=function(){this.io&&(this.io.cancel(),this.io=null)},Rh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._o(),this.Xn.cancel(),this.so++,3!==e?this.Xn.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(Sr(n.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.Xn.Rn()):n&&n.code===Ir.UNAUTHENTICATED&&this.no.jr(),null!==this.stream&&(this.fo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.do(n)];case 1:return t.sent(),[2]}})})},Rh.prototype.fo=function(){},Rh.prototype.auth=function(){var n=this;this.state=1;var t=this.wo(this.so),e=this.so;this.no.getToken().then(function(t){n.so===e&&n.mo(t)},function(e){t(function(){var t=new Tr(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.To(t)})})},Rh.prototype.mo=function(t){var e=this,n=this.wo(this.so);this.stream=this.Eo(t),this.stream.Io(function(){n(function(){return e.state=2,e.listener.Io()})}),this.stream.do(function(t){n(function(){return e.To(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Rh.prototype.uo=function(){var t=this;this.state=4,this.Xn.yn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Rh.prototype.To=function(t){return Or("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Rh.prototype.wo=function(e){var n=this;return function(t){n.fn.jn(function(){return n.so===e?t():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Rh),mh=(n(Nh,lh=l),Nh.prototype.Eo=function(t){return this.eo.Ao("Listen",t)},Nh.prototype.onMessage=function(t){this.Xn.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Vr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Qe?(_r(void 0===o||"string"==typeof o),yi.fromBase64String(o||"")):(_r(void 0===o||o instanceof Uint8Array),yi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:Wi(s.code),new Tr(o,s.message||"")),r=new go(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=is(t,u.document.name),a=es(u.document.updateTime),s=new nu({mapValue:{fields:u.document.fields}}),a=new lu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new yo(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=is(t,u.document),h=u.readTime?es(u.readTime):Oi.min(),h=new fu(a,h),u=u.removedTargetIds||[];r=new yo([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=is(t,h.document),h=h.removedTargetIds||[];r=new yo([],h,c,null)}else{if(!("filter"in e))return Vr();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new Fi(e),c=c.targetId;r=new vo(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return Oi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?es(t.readTime):Oi.min()}(t);return this.listener.Ro(e,t)},Nh.prototype.yo=function(t){var e,n,r,i={};i.database=ss(this.serializer),i.addTarget=(e=this.serializer,(r=xi(r=(n=t).target)?{documents:{documents:[os(e,r.path)]}}:{query:hs(e,r)}).targetId=n.targetId,0<n.resumeToken.L()&&(r.resumeToken=ts(e,n.resumeToken)),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Vr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.lo(i)},Nh.prototype.Po=function(t){var e={};e.database=ss(this.serializer),e.removeTarget=t,this.lo(e)},Nh),wh=(n(Ah,ch=l),Object.defineProperty(Ah.prototype,"Vo",{get:function(){return this.po},enumerable:!1,configurable:!0}),Ah.prototype.start=function(){this.po=!1,this.lastStreamToken=void 0,ch.prototype.start.call(this)},Ah.prototype.fo=function(){this.po&&this.vo([])},Ah.prototype.Eo=function(t){return this.eo.Ao("Write",t)},Ah.prototype.onMessage=function(t){if(_r(!!t.streamToken),this.lastStreamToken=t.streamToken,this.po){this.Xn.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(_r(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?es(t.updateTime):es(e);n.isEqual(Oi.min())&&(n=es(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Us(n,e)}(t,r)})):[]),n=es(t.commitTime);return this.listener.bo(n,e)}var n,r;return _r(!t.writeResults||0===t.writeResults.length),this.po=!0,this.listener.So()},Ah.prototype.Do=function(){var t={};t.database=ss(this.serializer),this.lo(t)},Ah.prototype.vo=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return as(e.serializer,t)})};this.lo(t)},Ah),bh=(n(Th,hh=function(){}),Th.prototype.Fo=function(){if(this.Co)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},Th.prototype.No=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.No(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.jr(),t})},Th.prototype.$o=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.$o(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.jr(),t})},Th.prototype.terminate=function(){this.Co=!1},Th),Eh=(Ih.prototype.Lo=function(){var t=this;0===this.xo&&(this.Mo("Unknown"),this.ko=this.On.gn("online_state_timeout",1e4,function(){return t.ko=null,t.qo("Backend didn't respond within 10 seconds."),t.Mo("Offline"),Promise.resolve()}))},Ih.prototype.Uo=function(t){"Online"===this.state?this.Mo("Unknown"):(this.xo++,1<=this.xo&&(this.Bo(),this.qo("Connection failed 1 times. Most recent error: "+t.toString()),this.Mo("Offline")))},Ih.prototype.set=function(t){this.Bo(),this.xo=0,"Online"===t&&(this.Oo=!1),this.Mo(t)},Ih.prototype.Mo=function(t){t!==this.state&&(this.state=t,this.js(t))},Ih.prototype.qo=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Oo?(Sr(t),this.Oo=!1):Or("OnlineStateTracker",t)},Ih.prototype.Bo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},Ih);function Ih(t,e){this.On=t,this.js=e,this.state="Unknown",this.xo=0,this.ko=null,this.Oo=!0}function Th(t,e,n){var r=this;return(r=hh.call(this)||this).credentials=t,r.eo=e,r.serializer=n,r.Co=!1,r}function Ah(t,e,n,r,i){var o=this;return(o=ch.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.po=!1,o}function Nh(t,e,n,r,i){var o=this;return(o=lh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Rh(t,e,n,r,i,o){this.fn=t,this.Zr=n,this.eo=r,this.no=i,this.listener=o,this.state=0,this.so=0,this.io=null,this.stream=null,this.Xn=new la(t,e)}function Oh(t,e){this.Jr=t,this.Xr=e}function Sh(t,e){this.Jr=t,this.Xr=e,this.type="FirstParty",this.user=Sa.Ns}function Dh(t){var e=this;this.zr=null,this.currentUser=Sa.UNAUTHENTICATED,this.Kr=!1,this.Hr=0,this.Qr=null,this.forceRefresh=!1,this.zr=function(){e.Hr++,e.currentUser=e.Yr(),e.Kr=!0,e.Qr&&e.Qr(e.currentUser)},this.Hr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.zr):(this.zr(null),t.get().then(function(t){e.auth=t,e.zr&&e.auth.addAuthTokenListener(e.zr)},function(){}))}function Lh(){this.Qr=null}function Vh(t,e){this.key=t,this.Ur=e}function _h(){this.vr=new Zi(ph.br),this.Sr=new Zi(ph.Dr)}function Uh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Bh(r))return[3,4];e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function kh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function jh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Or("RemoteStore","RemoteStore shutting down."),e.Ko.add(5),[4,kh(e)];case 1:return t.sent(),e.Yo.ni(),e.Xo.set("Unknown"),[2]}})})}function Ph(t,e){t.zo.has(e.targetId)||(t.zo.set(e.targetId,e),qh(t)?Fh(t):Yh(t).oo()&&Mh(t,e))}function Ch(t,e){var n=t,t=Yh(n);n.zo.delete(e),t.oo()&&xh(n,e),0===n.zo.size&&(t.oo()?t.ao():Bh(n)&&n.Xo.set("Unknown"))}function Mh(t,e){t.Zo.Ie(e.targetId),Yh(t).yo(e)}function xh(t,e){t.Zo.Ie(e),Yh(t).Po(e)}function Fh(e){e.Zo=new wo({Ue:function(t){return e.Wo.Ue(t)},Be:function(t){return e.zo.get(t)||null}}),Yh(e).start(),e.Xo.Lo()}function qh(t){return Bh(t)&&!Yh(t).ro()&&0<t.zo.size}function Bh(t){return 0===t.Ko.size}function Gh(t){t.Zo=void 0}function zh(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Xo.set("Online"),!(u instanceof go&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zo.has(i)?[4,o.Wo.tu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zo.delete(i),o.Zo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Or("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Wh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof yo?s.Zo.ve(u):u instanceof vo?s.Zo.xe(u):s.Zo.De(u),a.isEqual(Oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,nh(s.Qo)];case 8:return o=t.sent(),0<=a.M(o)?[4,(i=a,(e=(r=s).Zo.Le(i)).Kt.forEach(function(t,e){var n;0<t.resumeToken.L()&&((n=r.zo.get(e))&&r.zo.set(e,n.it(t.resumeToken,i)))}),e.Ht.forEach(function(t){var e=r.zo.get(t);e&&(r.zo.set(t,e.it(yi.q,e.nt)),xh(r,t),e=new Bi(e.target,t,1,e.sequenceNumber),Mh(r,e))}),r.Wo.eu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Or("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Wh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Wh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ya(r))throw r;return n.Ko.add(1),[4,kh(n)];case 1:return t.sent(),n.Xo.set("Offline"),i=i||function(){return nh(n.Qo)},n.On.os(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Or("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Ko.delete(1),[4,Uh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Qh(e,n){return n().catch(function(t){return Wh(e,t,n)})}function Hh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Jh(i=a),s=0<i.Go.length?i.Go[i.Go.length-1].batchId:-1,t.label=1;case 1:if(!(Bh(i)&&i.Go.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Qo,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.li.Pr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Go.length&&o.ao(),[3,7]):(s=u.batchId,function(t,e){t.Go.push(e);t=Jh(t);t.oo()&&t.Vo&&t.vo(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Wh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Xh(i)&&Kh(i),[2]}var e,n,r})})}function Xh(t){return Bh(t)&&!Jh(t).ro()&&0<t.Go.length}function Kh(t){Jh(t).start()}function Yh(n){var t,e,r,i=this;return n.iu||(n.iu=(t=n.jo,e=n.On,r={Io:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zo.forEach(function(t,e){Mh(n,t)}),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Gh(e),qh(e)?(e.Xo.Uo(n),Fh(e)):e.Xo.set("Unknown"),[2]})})}.bind(null,n),Ro:zh.bind(null,n)},t.Fo(),new mh(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.iu.co(),qh(n)?Fh(n):n.Xo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.iu.stop()];case 2:t.sent(),Gh(n),t.label=3;case 3:return[2]}})})})),n.iu}function Jh(n){var t,e,r,i=this;return n.ru||(n.ru=(t=n.jo,e=n.On,r={Io:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Jh(e).Do(),[2]})})}.bind(null,n),do:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Jh(e).Vo?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return zi(n=i.code)&&n!==Ir.ABORTED?(e=r.Go.shift(),Jh(r).co(),[4,Qh(r,function(){return r.Wo.su(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Hh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Xh(e)&&Kh(e),[2]}})})}.bind(null,n),So:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Jh(o),n=0,r=o.Go;n<r.length;n++)i=r[n],e.vo(i.mutations);return[2]})})}.bind(null,n),bo:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Go.shift(),n=Pa.from(e,i,o),[4,Qh(r,function(){return r.Wo.nu(n)})];case 1:return t.sent(),[4,Hh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Fo(),new wh(e,t.eo,t.credentials,t.serializer,r)),n.Ho.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.ru.co(),[4,Hh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ru.stop()];case 3:t.sent(),0<n.Go.length&&(Or("RemoteStore","Stopping write stream with "+n.Go.length+" pending writes"),n.Go=[]),t.label=4;case 4:return[2]}})})})),n.ru}function $h(t,e,n){this.query=t,this.targetId=e,this.view=n}var Zh=function(t){this.key=t},tc=function(t){this.key=t},ec=(Object.defineProperty(oc.prototype,"lu",{get:function(){return this.ou},enumerable:!1,configurable:!0}),oc.prototype._u=function(t,e){var s=this,u=e?e.fu:new co,a=(e||this).hu,h=(e||this).jt,c=a,l=!1,f=wu(this.query)&&a.size===this.query.limit?a.last():null,p=bu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ht(function(t,e){var n=a.get(t),r=(r=e instanceof lu?e:null)&&(_u(s.query,r)?r:null),i=!!n&&s.jt.has(n.key),o=!!r&&(r.Je||s.jt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.du(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.au(r,f)||p&&s.au(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),wu(this.query)||bu(this.query))for(;c.size>this.query.limit;){var n=wu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{hu:c,fu:u,wu:l,jt:h}},oc.prototype.du=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},oc.prototype.mu=function(t,e,n){var o=this,r=this.hu;this.hu=t.hu,this.jt=t.jt;var i=t.fu.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.au(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Vr()}}var r,i}),this.Tu(n);var s=e?this.Eu():[],n=0===this.cu.size&&this.te?1:0,e=n!==this.uu;return this.uu=n,0!==i.length||e?{snapshot:new lo(this.query,t.hu,r,i,t.jt,0==n,e,!1),Iu:s}:{Iu:s}},oc.prototype.As=function(t){return this.te&&"Offline"===t?(this.te=!1,this.mu({hu:this.hu,fu:new co,jt:this.jt,wu:!1},!1)):{Iu:[]}},oc.prototype.Au=function(t){return!this.ou.has(t)&&!!this.hu.has(t)&&!this.hu.get(t).Je},oc.prototype.Tu=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.ou=e.ou.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.ou=e.ou.delete(t)}),this.te=t.te)},oc.prototype.Eu=function(){var e=this;if(!this.te)return[];var n=this.cu;this.cu=uo(),this.hu.forEach(function(t){e.Au(t.key)&&(e.cu=e.cu.add(t.key))});var r=[];return n.forEach(function(t){e.cu.has(t)||r.push(new tc(t))}),this.cu.forEach(function(t){n.has(t)||r.push(new Zh(t))}),r},oc.prototype.Ru=function(t){this.ou=t.Vr,this.cu=uo();t=this._u(t.documents);return this.mu(t,!0)},oc.prototype.yu=function(){return lo.zt(this.query,this.hu,this.jt,0===this.uu)},oc),nc=function(t){this.key=t,this.Pu=!1},rc=(Object.defineProperty(ic.prototype,"Mu",{get:function(){return!0===this.Lu},enumerable:!1,configurable:!0}),ic);function ic(t,e,n,r,i,o){this.Qo=t,this.gu=e,this.pu=n,this.Vu=r,this.currentUser=i,this.vu=o,this.bu={},this.Su=new Ni(Lu,Du),this.Du=new Map,this.Cu=[],this.Fu=new Qi(qr.i),this.Nu=new Map,this.$u=new fh,this.xu={},this.ku=new Map,this.Ou=Ka.Gi(),this.onlineState="Unknown",this.Lu=void 0}function oc(t,e){this.query=t,this.ou=e,this.uu=null,this.te=!1,this.cu=uo(),this.jt=uo(),this.au=Uu(t),this.hu=new ho(this.au)}function sc(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).gu.Wo.eu=ac.bind(null,e),e.gu.Wo.Ue=function(t,e){var n=t,t=n.Nu.get(e);if(t&&t.Pu)return uo().add(t.key);var r=uo(),e=n.Du.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.Su.get(s);r=r.kt(s.view.lu)}return r}.bind(null,e),e.gu.Wo.tu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Vu.Ks(s,"rejected",u),i=e.Nu.get(s),(n=i&&i.key)?(r=(r=new Qi(qr.i)).ot(n,new fu(n,Oi.min())),i=uo().add(n),i=new fo(Oi.min(),new Map,new Zi(pi),r,i),[4,ac(e,i)]):[3,2];case 1:return t.sent(),e.Fu=e.Fu.remove(n),e.Nu.delete(s),yc(e),[3,4];case 2:return[4,ih(e.Qo,s,!1).then(function(){return fc(e,s,u)}).catch(sh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.bu.Ro=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.Ts.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Rs(s)&&(r=!0);u.ws=s}}r&&Ra(n)}.bind(null,e.pu),e.bu.qu=function(t,e,n){var r=t;if(t=r.Ts.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Ts.delete(e)}.bind(null,e.pu),(a=(n=e).Su.get(c))?(o=a.targetId,n.Vu.zs(o),s=a.view.yu(),[3,4]):[3,1];case 1:return[4,(e=n.Qo,r=Nu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.tr.gr(e,r).next(function(t){return t?(n=t,fa.resolve(n)):i.tr.Uu(e).next(function(t){return n=new Bi(r,t,0,e.Tr),i.tr.Bu(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ki.get(t.targetId);return(null===e||0<t.nt.M(e.nt))&&(i.Ki=i.Ki.ot(t.targetId,t),i.Hi.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.Vu.zs(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Qu=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view._u(o)).wu?[4,oh(r.Qo,i.query,!1).then(function(t){t=t.documents;return i.view._u(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Kt.get(i.targetId),n=i.view.mu(e,r.Mu,n),[2,(dc(r,i.targetId,n.Iu),n.snapshot)]}})})}(i,t,e,n)},[4,oh(i.Qo,o,!0)];case 1:return n=t.sent(),r=new ec(o,n.Vr),e=r._u(n.documents),n=po.Zt(s,u&&"Offline"!==i.onlineState),n=r.mu(e,i.Mu,n),dc(i,s,n.Iu),r=new $h(o,s,r),i.Su.set(o,r),i.Du.has(s)?i.Du.get(s).push(o):i.Du.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Mu&&Ph(n.gu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function uc(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).gu.Wo.nu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,eh(e.Qo,o)];case 2:return r=t.sent(),lc(e,n,null),cc(e,n),e.Vu.Gs(n,"acknowledged"),[4,vc(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,sh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.gu.Wo.su=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.li.Gu(e,r).next(function(t){return _r(null!==t),n=t.keys(),i.li.lr(e,t)}).next(function(){return i.li._r(e)}).next(function(){return i.nr.Ei(e,n)})}))];case 2:return o=t.sent(),lc(n,u,a),cc(n,u),n.Vu.Gs(u,"rejected",a),[4,vc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,sh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Qo,a=p,c=r,l=Ri.now(),i=a.reduce(function(t,e){return t.add(e.key)},uo()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.nr.Ei(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Ks?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof lu?t.field(i.field):void 0,o=ps(i.transform,o||null);null!=o&&(e=(null==e?new ru:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new zs(i.key,o,function s(t){var u=[];return kr(t.fields||{},function(t,e){var n=new Fr([t]);if(Qo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Vs(u)}(o.proto.mapValue),ks.exists(!0)))}return c.li.ju(u,l,e,a)})}).then(function(t){var e=t.ui(h);return{batchId:t.batchId,Wu:e}}))];case 2:return s=t.sent(),u.Vu.Ws(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.xu[e.currentUser.Cs()])||new Qi(pi)).ot(n,o),e.xu[e.currentUser.Cs()]=r,[4,vc(u,s.Wu)];case 3:return t.sent(),[4,Hh(u.gu)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ea(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function ac(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,rh(n.Qo,i)];case 2:return e=t.sent(),i.Kt.forEach(function(t,e){e=n.Nu.get(e);e&&(_r(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.Pu=!0:0<t.ne.size?_r(e.Pu):0<t.se.size&&(_r(e.Pu),e.Pu=!1))}),[4,vc(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,sh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function hc(t,n,e){var r,t=t;(t.Mu&&0===e||!t.Mu&&1===e)&&(r=[],t.Su.forEach(function(t,e){e=e.view.As(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Ts.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&Ra(t)}(t.pu,n),r.length&&t.bu.Ro(r),t.onlineState=n,t.Mu&&t.Vu.ei(n))}function cc(t,e){(t.ku.get(e)||[]).forEach(function(t){t.resolve()}),t.ku.delete(e)}function lc(t,e,n){var r=t,i=r.xu[r.currentUser.Cs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.xu[r.currentUser.Cs()]=i)}function fc(e,t,n){void 0===n&&(n=null),e.Vu.Hs(t);for(var r=0,i=e.Du.get(t);r<i.length;r++){var o=i[r];e.Su.delete(o),n&&e.bu.qu(o,n)}e.Du.delete(t),e.Mu&&e.$u.Or(t).forEach(function(t){e.$u.qr(t)||pc(e,t)})}function pc(t,e){var n=t.Fu.get(e);null!==n&&(Ch(t.gu,n),t.Fu=t.Fu.remove(e),t.Nu.delete(n),yc(t))}function dc(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Zh?(t.$u.Cr(o.key,e),function(t,e){e=e.key;t.Fu.get(e)||(Or("SyncEngine","New document in limbo: "+e),t.Cu.push(e),yc(t))}(t,o)):o instanceof tc?(Or("SyncEngine","Document no longer in limbo: "+o.key),t.$u.Nr(o.key,e),t.$u.qr(o.key)||pc(t,o.key)):Vr()}}function yc(t){for(;0<t.Cu.length&&t.Fu.size<t.vu;){var e=t.Cu.shift(),n=t.Ou.next();t.Nu.set(n,new nc(e)),t.Fu=t.Fu.ot(e,n),Ph(t.gu,new Bi(Nu(mu(e.path)),n,2,Va.Ls))}}function vc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Su.m()?[3,3]:(n.Su.forEach(function(t,e){o.push(n.Qu(e,s,u).then(function(t){t&&(n.Mu&&n.Vu.Ks(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ma.Di(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.bu.Ro(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return fa.forEach(h,function(e){return fa.forEach(e.bi,function(t){return r.persistence.Rr.Cr(n,e.targetId,t)}).next(function(){return fa.forEach(e.Si,function(t){return r.persistence.Rr.Nr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ya(e=t.sent()))throw e;return Or("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Ki.get(o),u=s.nt,u=s.rt(u),r.Ki=r.Ki.ot(o,u));return[2]}})})}(n.Qo,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function gc(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Or("SyncEngine","User change. New user:",o.Cs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).li,m=e.nr,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.li.Ku(v).next(function(t){return g=t,n=e.persistence.Ji(o),m=new Ca(e.Xi,n,e.persistence.sr()),n.Ku(v)}).next(function(t){for(var e=[],n=[],r=uo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Ei(v,r).next(function(t){return{Hu:t,Yu:e,Ju:n}})})})];case 1:return r=t.sent(),[2,(e.li=n,e.nr=m,e.zi.ir(e.nr),r)]}})})}(n.Qo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).ku.forEach(function(t){t.forEach(function(t){t.reject(new Tr(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ku.clear(),n.Vu.ti(o,r.Yu,r.Ju),[4,vc(n,r.Hu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var mc,wc,bc,Ec=(Xc.prototype.ir=function(t){this.Xu=t},Xc.prototype.Ri=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.V())||i.isEqual(Oi.min())?this.Zu(e,r):this.Xu.Ei(e,o).next(function(t){var n=s.tc(r,t);return(wu(r)||bu(r))&&s.wu(r.un,n,o,i)?s.Zu(e,r):(Rr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Vu(r)),s.Xu.Ri(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Xc.prototype.tc=function(n,t){var r=new Zi(Uu(n));return t.forEach(function(t,e){e instanceof lu&&_u(n,e)&&(r=r.add(e))}),r},Xc.prototype.wu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.M(r))},Xc.prototype.Zu=function(t,e){return Rr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Using full collection scan to execute query:",Vu(e)),this.Xu.Ri(t,e,Oi.min())},Xc),Ic=(Hc.prototype.sc=function(t){return fa.resolve(0===this.li.length)},Hc.prototype.ju=function(t,e,n,r){var i=this.ec;this.ec++,0<this.li.length&&this.li[this.li.length-1];n=new ja(i,e,n,r);this.li.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.nc=this.nc.add(new ph(u.key,i)),this._i.Qi(t,u.key.path.h())}return fa.resolve(n)},Hc.prototype.Gu=function(t,e){return fa.resolve(this.ic(e))},Hc.prototype.Pr=function(t,e){e+=1,e=this.rc(e),e=e<0?0:e;return fa.resolve(this.li.length>e?this.li[e]:null)},Hc.prototype.zu=function(){return fa.resolve(0===this.li.length?-1:this.ec-1)},Hc.prototype.Ku=function(t){return fa.resolve(this.li.slice())},Hc.prototype.di=function(t,e){var n=this,r=new ph(e,0),e=new ph(e,Number.POSITIVE_INFINITY),i=[];return this.nc.Nt([r,e],function(t){t=n.ic(t.Ur);i.push(t)}),fa.resolve(i)},Hc.prototype.Ai=function(t,e){var n=this,r=new Zi(pi);return e.forEach(function(t){var e=new ph(t,0),t=new ph(t,Number.POSITIVE_INFINITY);n.nc.Nt([e,t],function(t){r=r.add(t.Ur)})}),fa.resolve(this.oc(r))},Hc.prototype.Vi=function(t,e){var n=e.path,r=n.length+1,e=n;qr.N(e)||(e=e.child(""));var e=new ph(new qr(e),0),i=new Zi(pi);return this.nc.$t(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.Ur)),!0)},e),fa.resolve(this.oc(i))},Hc.prototype.oc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.ic(t);null!==t&&n.push(t)}),n},Hc.prototype.lr=function(n,r){var i=this;_r(0===this.uc(r.batchId,"removed")),this.li.shift();var o=this.nc;return fa.forEach(r.mutations,function(t){var e=new ph(t.key,r.batchId);return o=o.delete(e),i.Rr.cc(n,t.key)}).next(function(){i.nc=o})},Hc.prototype.ac=function(t){},Hc.prototype.qr=function(t,e){var n=new ph(e,0),n=this.nc.xt(n);return fa.resolve(e.isEqual(n&&n.key))},Hc.prototype._r=function(t){return this.li.length,fa.resolve()},Hc.prototype.uc=function(t,e){return this.rc(t)},Hc.prototype.rc=function(t){return 0===this.li.length?0:t-this.li[0].batchId},Hc.prototype.ic=function(t){t=this.rc(t);return t<0||t>=this.li.length?null:this.li[t]},Hc),Tc=(Qc.prototype.hr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.hc(e);return this.docs=this.docs.ot(r,{lc:e,size:i,readTime:n}),this.size+=i-o,this._i.Qi(t,r.path.h())},Qc.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Qc.prototype.mi=function(t,e){e=this.docs.get(e);return fa.resolve(e?e.lc:null)},Qc.prototype.getEntries=function(t,e){var n=this,r=eo;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.lc:null)}),fa.resolve(r)},Qc.prototype.Ri=function(t,e,n){for(var r=io,i=new qr(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),u=s.key,a=s.value,s=a.lc,a=a.readTime;if(!e.path.T(u.path))break;a.M(n)<=0||s instanceof lu&&_u(e,s)&&(r=r.ot(s.key,s))}return fa.resolve(r)},Qc.prototype._c=function(t,e){return fa.forEach(this.docs,function(t){return e(t)})},Qc.prototype.cr=function(t){return new Ac(this)},Qc.prototype.fc=function(t){return fa.resolve(this.size)},Qc),Ac=(Object.defineProperty(Wc.prototype,"readTime",{get:function(){return this.wc},set:function(t){this.wc=t},enumerable:!1,configurable:!0}),Wc.prototype.hr=function(t,e){this.mc(),this.readTime=e,this.Wu.set(t.key,t)},Wc.prototype.Ir=function(t,e){this.mc(),e&&(this.readTime=e),this.Wu.set(t,null)},Wc.prototype.mi=function(t,e){this.mc();var n=this.Wu.get(e);return void 0!==n?fa.resolve(n):this.Tc(t,e)},Wc.prototype.getEntries=function(t,e){return this.Ec(t,e)},Wc.prototype.apply=function(t){return this.mc(),this.dc=!0,this.mu(t)},Wc.prototype.mc=function(){},n(zc,bc=Wc),zc.prototype.mu=function(n){var r=this,i=[];return this.Wu.forEach(function(t,e){e?i.push(r.Ic.hr(n,e,r.readTime)):r.Ic.Ir(t)}),fa.xn(i)},zc.prototype.Tc=function(t,e){return this.Ic.mi(t,e)},zc.prototype.Ec=function(t,e){return this.Ic.getEntries(t,e)},zc),Nc=(Gc.prototype.Ce=function(t,n){return this.Ac.forEach(function(t,e){return n(e)}),fa.resolve()},Gc.prototype.dr=function(t){return fa.resolve(this.lastRemoteSnapshotVersion)},Gc.prototype.gc=function(t){return fa.resolve(this.Rc)},Gc.prototype.Uu=function(t){return this.highestTargetId=this.Pc.next(),fa.resolve(this.highestTargetId)},Gc.prototype.yr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Rc&&(this.Rc=e),fa.resolve()},Gc.prototype.Vc=function(t){this.Ac.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Pc=new Ka(e),this.highestTargetId=e),t.sequenceNumber>this.Rc&&(this.Rc=t.sequenceNumber)},Gc.prototype.Bu=function(t,e){return this.Vc(e),this.targetCount+=1,fa.resolve()},Gc.prototype.Er=function(t,e){return this.Vc(e),fa.resolve()},Gc.prototype.vc=function(t,e){return this.Ac.delete(e.target),this.yc.Or(e.targetId),--this.targetCount,fa.resolve()},Gc.prototype.bc=function(n,r,i){var o=this,s=0,u=[];return this.Ac.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ac.delete(t),u.push(o.Sc(n,e.targetId)),s++)}),fa.xn(u).next(function(){return s})},Gc.prototype.Dc=function(t){return fa.resolve(this.targetCount)},Gc.prototype.gr=function(t,e){e=this.Ac.get(e)||null;return fa.resolve(e)},Gc.prototype.mr=function(t,e,n){return this.yc.Fr(e,n),fa.resolve()},Gc.prototype.wr=function(e,t,n){this.yc.kr(t,n);var r=this.persistence.Rr,i=[];return r&&t.forEach(function(t){i.push(r.cc(e,t))}),fa.xn(i)},Gc.prototype.Sc=function(t,e){return this.yc.Or(e),fa.resolve()},Gc.prototype.pr=function(t,e){e=this.yc.Mr(e);return fa.resolve(e)},Gc.prototype.qr=function(t,e){return fa.resolve(this.yc.qr(e))},Gc),Rc=(Bc.prototype.start=function(){return Promise.resolve()},Bc.prototype.ni=function(){return this.Nc=!1,Promise.resolve()},Object.defineProperty(Bc.prototype,"xc",{get:function(){return this.Nc},enumerable:!1,configurable:!0}),Bc.prototype.kc=function(){},Bc.prototype.Oc=function(){},Bc.prototype.sr=function(){return this._i},Bc.prototype.Ji=function(t){var e=this.Cc[t.Cs()];return e||(e=new Ic(this._i,this.Rr),this.Cc[t.Cs()]=e),e},Bc.prototype.er=function(){return this.tr},Bc.prototype.Zi=function(){return this.hi},Bc.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new Oc(this.Fc.next());return this.Rr.Lc(),n(i).next(function(t){return r.Rr.Mc(i).next(function(){return t})}).Nn().then(function(t){return i.qc(),t})},Bc.prototype.Uc=function(e,n){return fa.kn(Object.values(this.Cc).map(function(t){return function(){return t.qr(e,n)}}))},Bc),Oc=(qc.prototype.Qc=function(t){this.Bc.push(t)},qc.prototype.qc=function(){this.Bc.forEach(function(t){return t()})},n(Fc,wc=qc),Fc),Sc=(xc.Gc=function(t){return new xc(t)},Object.defineProperty(xc.prototype,"zc",{get:function(){if(this.Wc)return this.Wc;throw Vr()},enumerable:!1,configurable:!0}),xc.prototype.Cr=function(t,e,n){return this.jc.Cr(n,e),this.zc.delete(n.toString()),fa.resolve()},xc.prototype.Nr=function(t,e,n){return this.jc.Nr(n,e),this.zc.add(n.toString()),fa.resolve()},xc.prototype.cc=function(t,e){return this.zc.add(e.toString()),fa.resolve()},xc.prototype.removeTarget=function(t,e){var n=this;this.jc.Or(e.targetId).forEach(function(t){return n.zc.add(t.toString())});var r=this.persistence.er();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.zc.add(t.toString())})}).next(function(){return r.vc(t,e)})},xc.prototype.Lc=function(){this.Wc=new Set},xc.prototype.Mc=function(n){var r=this,i=this.persistence.Zi().cr();return fa.forEach(this.zc,function(t){var e=qr.D(t);return r.Kc(n,e).next(function(t){t||i.Ir(e)})}).next(function(){return r.Wc=null,i.apply(n)})},xc.prototype.Ar=function(t,e){var n=this;return this.Kc(t,e).next(function(t){t?n.zc.delete(e.toString()):n.zc.add(e.toString())})},xc.prototype.$c=function(t){return 0},xc.prototype.Kc=function(t,e){var n=this;return fa.kn([function(){return fa.resolve(n.jc.qr(e))},function(){return n.persistence.er().qr(t,e)},function(){return n.persistence.Uc(t,e)}])},xc),Dc=(Mc.prototype.Io=function(t){this.Jc=t},Mc.prototype.do=function(t){this.Xc=t},Mc.prototype.onMessage=function(t){this.Zc=t},Mc.prototype.close=function(){this.Yc()},Mc.prototype.send=function(t){this.Hc(t)},Mc.prototype.ta=function(){this.Jc()},Mc.prototype.ea=function(t){this.Xc(t)},Mc.prototype.na=function(t){this.Zc(t)},Mc),Lc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Vc=(Cc.prototype.No=function(e,t,n,r){var i=this.oa(e,t);Or("RestConnection","Sending: ",i,n);t={};return this.ua(t,r),this.ca(e,i,t,n).then(function(t){return Or("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Cc.prototype.$o=function(t,e,n,r){return this.No(t,e,n,r)},Cc.prototype.ua=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.24.0",t["Content-Type"]="text/plain",e)for(var n in e.Br)e.Br.hasOwnProperty(n)&&(t[n]=e.Br[n])},Cc.prototype.oa=function(t,e){t=Lc[t];return this.ia+"/v1/"+e+":"+t},n(Pc,mc=Cc),Pc.prototype.ca=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Or("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Or("Connection",'RPC "'+o+'" timed out'),r(new Tr(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Or("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Tr(e,t.message))):r(new Tr(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Tr(Ir.UNAVAILABLE,"Connection failed."));break;default:Vr()}}finally{Or("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Pc.prototype.Ao=function(t,e){var n,r=[this.ia,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new cr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.j};this.ua(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Or("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Dc({Hc:function(t){u?Or("Connection","Not sending because WebChannel is closed:",t):(s||(Or("Connection","Opening WebChannel transport."),o.open(),s=!0),Or("Connection","WebChannel sending:",t),o.send(t))},Yc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(gr.EventType.OPEN,function(){u||Or("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Or("Connection","WebChannel transport closed"),a.ea())}),t(gr.EventType.ERROR,function(t){u||(u=!0,Dr("Connection","WebChannel transport errored:",t),a.ea(new Tr(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(_r(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Or("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=qi[r];if(void 0!==t)return Wi(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.ea(new Tr(t,i)),o.close()):(Or("Connection","WebChannel received:",e),a.na(e)))}),setTimeout(function(){a.ta()},0),a},Pc),_c=(jc.prototype.Jo=function(t){this.fa.push(t)},jc.prototype.ni=function(){window.removeEventListener("online",this.aa),window.removeEventListener("offline",this.la)},jc.prototype.da=function(){window.addEventListener("online",this.aa),window.addEventListener("offline",this.la)},jc.prototype.ha=function(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.fa;t<e.length;t++)(0,e[t])(0)},jc.prototype._a=function(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.fa;t<e.length;t++)(0,e[t])(1)},jc.wa=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},jc),Uc=(kc.prototype.Jo=function(t){},kc.prototype.ni=function(){},kc);function kc(){}function jc(){var t=this;this.aa=function(){return t.ha()},this.la=function(){return t._a()},this.fa=[],this.da()}function Pc(t){var e=this;return(e=mc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.j=t.j,e}function Cc(t){this.sa=t,this.B=t.B;var e=t.ssl?"https":"http";this.ia=e+"://"+t.host,this.ra="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function Mc(t){this.Hc=t.Hc,this.Yc=t.Yc}function xc(t){this.persistence=t,this.jc=new fh,this.Wc=null}function Fc(t){var e=this;return(e=wc.call(this)||this).Tr=t,e}function qc(){this.Bc=[]}function Bc(t){var e=this;this.Cc={},this.Fc=new Va(0),this.Nc=!1,this.Nc=!0,this.Rr=t(this),this.tr=new Nc(this),this._i=new Ha,this.hi=(t=this._i,new Tc(t,function(t){return e.Rr.$c(t)}))}function Gc(t){this.persistence=t,this.Ac=new Ni(Ci,Mi),this.lastRemoteSnapshotVersion=Oi.min(),this.highestTargetId=0,this.Rc=0,this.yc=new fh,this.targetCount=0,this.Pc=Ka.Wi()}function zc(t){var e=this;return(e=bc.call(this)||this).Ic=t,e}function Wc(){this.Wu=new Ni(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.dc=!1}function Qc(t,e){this._i=t,this.hc=e,this.docs=new Qi(qr.i),this.size=0}function Hc(t,e){this._i=t,this.Rr=e,this.li=[],this.ec=1,this.nc=new Zi(ph.br)}function Xc(){}function Kc(t){return new Ko(t,!0)}var Yc,Jc,$c="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Zc=(ll.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Vu=this.ma(e),this.persistence=this.Ta(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ea=this.Ia(e),this.Qo=this.Aa(e),[2]}})})},ll.prototype.Ia=function(t){return null},ll.prototype.Aa=function(t){return e=this.persistence,n=new Ec,t=t.Ra,new Ya(e,n,t);var e,n},ll.prototype.Ta=function(t){if(t.persistenceSettings.ya)throw new Tr(Ir.FAILED_PRECONDITION,$c);return new Rc(Sc.Gc)},ll.prototype.ma=function(t){return new ka},ll.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ea&&this.Ea.stop(),[4,this.Vu.ni()];case 1:return t.sent(),[4,this.persistence.ni()];case 2:return t.sent(),[2]}})})},ll.prototype.clearPersistence=function(t,e){throw new Tr(Ir.FAILED_PRECONDITION,$c)},ll),tl=(cl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Qo?[3,2]:(this.Qo=n.Qo,this.Vu=n.Vu,this.jo=this.Pa(r),this.gu=this.ga(r),this.pu=this.pa(r),this.Va=this.va(r),this.Vu.js=function(t){return hc(e.Va,t,1)},this.gu.Wo.ba=gc.bind(null,this.Va),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Ko.delete(2),[4,Uh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Ko.add(2),[4,kh(e)]);case 3:t.sent(),e.Xo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.gu,this.Va.Mu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},cl.prototype.pa=function(t){return new Ta},cl.prototype.Pa=function(t){var e=Kc(t.sa.B),n=(n=t.sa,new Vc(n));return t=t.credentials,new bh(t,n,e)},cl.prototype.ga=function(t){var e=this,n=this.Qo,r=this.jo,i=t.On,o=function(t){return hc(e.Va,t,0)},t=new(_c.wa()?_c:Uc);return new ah(n,r,i,o,t)},cl.prototype.va=function(t){return function(t,e,n,r,i,o,s){o=new rc(t,e,n,r,i,o);return s&&(o.Lu=!0),o}(this.Qo,this.gu,this.pu,this.Vu,t.Ra,t.vu,!t.persistenceSettings.ya||!t.persistenceSettings.synchronizeTabs)},cl.prototype.terminate=function(){return jh(this.gu)},cl),el=(hl.prototype.next=function(t){this.observer.next&&this.Sa(this.observer.next,t)},hl.prototype.error=function(t){this.observer.error?this.Sa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},hl.prototype.Da=function(){this.muted=!0},hl.prototype.Sa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},hl),nl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Tr(Ir.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Yr("FieldPath","string",e,t[e]),0===t[e].length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ca=new Fr(t)},rl=(n(al,Jc=nl),al.documentId=function(){return new al(Fr.v().R())},al.prototype.isEqual=function(t){if(!(t instanceof al))throw ui("isEqual","FieldPath",1,t);return this.Ca.isEqual(t.Ca)},al),il=new RegExp("[~\\*/\\[\\]]"),ol=function(t){this.Fa=t},sl=(n(ul,Yc=ol),ul.prototype.Na=function(t){if(2!==t.$a)throw 1===t.$a?t.xa(this.Fa+"() can only appear at the top level of your update data"):t.xa(this.Fa+"() cannot be used with set() unless you pass {merge:true}");return t.je.push(t.path),null},ul.prototype.isEqual=function(t){return t instanceof ul},ul);function ul(){return null!==Yc&&Yc.apply(this,arguments)||this}function al(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Jc.call(this,t)||this}function hl(t){this.observer=t,this.muted=!1}function cl(){}function ll(){}function fl(t,e,n){return new jl({$a:3,ka:e.settings.ka,methodName:t.Fa,Oa:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var pl,dl,yl,vl,gl=(n(Ul,vl=ol),Ul.prototype.Na=function(t){return new Ls(t.path,new vs)},Ul.prototype.isEqual=function(t){return t instanceof Ul},Ul),ml=(n(_l,yl=ol),_l.prototype.Na=function(t){var e=fl(this,t,!0),n=this.La.map(function(t){return Gl(t,e)}),n=new gs(n);return new Ls(t.path,n)},_l.prototype.isEqual=function(t){return this===t},_l),wl=(n(Vl,dl=ol),Vl.prototype.Na=function(t){var e=fl(this,t,!0),n=this.La.map(function(t){return Gl(t,e)}),n=new Is(n);return new Ls(t.path,n)},Vl.prototype.isEqual=function(t){return this===t},Vl),bl=(n(Ll,pl=ol),Ll.prototype.Na=function(t){var e=new Rs(t.serializer,$o(t.serializer,this.Ma));return new Ls(t.path,e)},Ll.prototype.isEqual=function(t){return this===t},Ll),El=(Object.defineProperty(Dl.prototype,"latitude",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Object.defineProperty(Dl.prototype,"longitude",{get:function(){return this.Ua},enumerable:!1,configurable:!0}),Dl.prototype.isEqual=function(t){return this.qa===t.qa&&this.Ua===t.Ua},Dl.prototype.toJSON=function(){return{latitude:this.qa,longitude:this.Ua}},Dl.prototype.Y=function(t){return pi(this.qa,t.qa)||pi(this.Ua,t.Ua)},Dl),Il=function(t){this.Ba=t},Tl=/^__.*__$/,Al=function(t,e,n){this.Qa=t,this.ja=e,this.Wa=n},Nl=(Sl.prototype.Ga=function(t,e){var n=[];return null!==this.je?n.push(new zs(t,this.data,this.je,e)):n.push(new Gs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ks(t,this.fieldTransforms)),n},Sl),Rl=(Ol.prototype.Ga=function(t,e){e=[new zs(t,this.data,this.je,e)];return 0<this.fieldTransforms.length&&e.push(new Ks(t,this.fieldTransforms)),e},Ol);function Ol(t,e,n){this.data=t,this.je=e,this.fieldTransforms=n}function Sl(t,e,n){this.data=t,this.je=e,this.fieldTransforms=n}function Dl(t,e){if(Hr("GeoPoint",arguments,2),Yr("GeoPoint","number",1,t),Yr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Tr(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Tr(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.qa=t,this.Ua=e}function Ll(t,e){var n=this;return(n=pl.call(this,t)||this).Ma=e,n}function Vl(t,e){var n=this;return(n=dl.call(this,t)||this).La=e,n}function _l(t,e){var n=this;return(n=yl.call(this,t)||this).La=e,n}function Ul(){return null!==vl&&vl.apply(this,arguments)||this}function kl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Vr()}}var jl=(Object.defineProperty(Ml.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ml.prototype,"$a",{get:function(){return this.settings.$a},enumerable:!1,configurable:!0}),Ml.prototype.Ka=function(t){return new Ml(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.je)},Ml.prototype.Ha=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Ka({path:e,Oa:!1});return e.Ya(t),e},Ml.prototype.Ja=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Ka({path:t,Oa:!1});return t.za(),t},Ml.prototype.Xa=function(t){return this.Ka({path:void 0,Oa:!0})},Ml.prototype.xa=function(t){return Kl(t,this.settings.methodName,this.settings.Za||!1,this.path,this.settings.ka)},Ml.prototype.contains=function(e){return void 0!==this.je.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Ml.prototype.za=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ya(this.path.get(t))},Ml.prototype.Ya=function(t){if(0===t.length)throw this.xa("Document fields must not be empty");if(kl(this.$a)&&Tl.test(t))throw this.xa('Document fields cannot begin and end with "__"')},Ml),Pl=(Cl.prototype.th=function(t,e,n,r){return void 0===r&&(r=!1),new jl({$a:t,methodName:e,ka:n,path:Fr.g(),Oa:!1,Za:r},this.B,this.serializer,this.ignoreUndefinedProperties)},Cl);function Cl(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||Kc(t)}function Ml(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.za(),this.fieldTransforms=i||[],this.je=o||[]}function xl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.th(o.merge||o.mergeFields?2:0,e,n,i);Ql("Data must be an object, but it was:",s,r);var u,a,r=zl(r,s);if(o.merge)u=new Vs(s.je),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof nl)p=f.Ca;else{if("string"!=typeof f)throw Vr();p=Xl(e,f,n)}if(!s.contains(p))throw new Tr(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Yl(h,p)||h.push(p)}u=new Vs(h),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new Nl(new nu(r),u,a)}function Fl(t,r,i,e){var o=t.th(1,r,i);Ql("Data must be an object, but it was:",o,e);var s=[],u=new ru;kr(e,function(t,e){var n=Xl(r,t,i),t=o.Ja(n);e instanceof sl||e instanceof Il&&e.Ba instanceof sl?s.push(n):null!=(t=Gl(e,t))&&(s.push(n),u.set(n,t))});e=new Vs(s);return new Rl(u.Xe(),e,o.fieldTransforms)}function ql(t,e,n,r,i,o){var s=t.th(1,e,n),u=[Hl(e,r,n)],a=[i];if(o.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Hl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new ru,y=u.length-1;0<=y;--y){Yl(p,u[y])||(c=u[y],l=a[y],f=s.Ja(c),l instanceof sl||l instanceof Il&&l.Ba instanceof sl?p.push(c):null!=(f=Gl(l,f))&&(p.push(c),d.set(c,f)))}i=new Vs(p);return new Rl(d.Xe(),i,s.fieldTransforms)}function Bl(t,e,n,r){return void 0===r&&(r=!1),Gl(n,t.th(r?4:3,e))}function Gl(s,t){if(s instanceof Il&&(s=s.Ba),Wl(s))return Ql("Unsupported field value:",t,s),zl(s,t);if(s instanceof ol)return function(t,e){if(!kl(e.$a))throw e.xa(t.Fa+"() can only be used with update() and set()");if(!e.path)throw e.xa(t.Fa+"() is not currently supported inside arrays");t=t.Na(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.je.push(t.path),s instanceof Array){if(t.settings.Oa&&4!==t.$a)throw t.xa("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Gl(i[r],t.Xa(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return $o(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ri.fromDate(t);return{timestampValue:Zo(e.serializer,n)}}if(t instanceof Ri){var r=new Ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Zo(e.serializer,r)}}if(t instanceof El)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof gi)return{bytesValue:ts(e.serializer,t.U)};if(t instanceof Al){n=e.B,r=t.Qa;if(!r.isEqual(n))throw e.xa("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ns(t.Qa||e.B,t.ja.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.xa("Unsupported field value: "+ii(t))}(s,t)}function zl(t,n){var r={};return jr(t)?n.path&&0<n.path.length&&n.je.push(n.path):kr(t,function(t,e){e=Gl(e,n.Ha(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Wl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ri||t instanceof El||t instanceof gi||t instanceof Al||t instanceof ol)}function Ql(t,e,n){if(!Wl(n)||!ri(n)){n=ii(n);throw"an object"===n?e.xa(t+" a custom object"):e.xa(t+" "+n)}}function Hl(t,e,n){if(e instanceof nl)return e.Ca;if("string"==typeof e)return Xl(t,e);throw Kl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Xl(t,e,n){try{return function(e){if(0<=e.search(il))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(rl.bind.apply(rl,i([void 0],e.split("."))))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ca}catch(e){throw Kl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Kl(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Tr(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function Yl(t,e){return t.some(function(t){return t.isEqual(e)})}var Jl=(nf.prototype.rh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.oh(),0<this.mutations.length)throw new Tr(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=ss((n=s).serializer)+"/documents",r={documents:u.map(function(t){return rs(n.serializer,t)})},[4,n.$o("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){_r(!!e.found),e.found.name,e.found.updateTime;var n=is(t,e.found.name),t=es(e.found.updateTime),e=new nu({mapValue:{fields:e.found.fields}});return new lu(n,t,e,{})}(e,t):"missing"in t?function(t,e){_r(!!e.missing),_r(!!e.readTime);t=is(t,e.missing),e=es(e.readTime);return new fu(t,e)}(e,t):Vr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());_r(!!t),o.push(t)}),o)]}})})}(this.jo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof fu||t instanceof lu?n.uh(t):Vr()}),e)]}})})},nf.prototype.set=function(t,e){this.write(e.Ga(t,this.ze(t))),this.ih.add(t.toString())},nf.prototype.update=function(t,e){try{this.write(e.Ga(t,this.ah(t)))}catch(t){this.sh=t}this.ih.add(t.toString())},nf.prototype.delete=function(t){this.write([new tu(t,this.ze(t))]),this.ih.add(t.toString())},nf.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.oh(),this.sh)throw this.sh;return e=this.eh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=qr.D(e);n.mutations.push(new eu(e,n.ze(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ss((e=i).serializer)+"/documents",r={writes:o.map(function(t){return as(e.serializer,t)})},[4,e.No("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.jo,this.mutations)];case 1:return t.sent(),this.nh=!0,[2]}})})},nf.prototype.uh=function(t){var e;if(t instanceof lu)e=t.version;else{if(!(t instanceof fu))throw Vr();e=Oi.min()}var n=this.eh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Tr(Ir.ABORTED,"Document version changed between two reads.")}else this.eh.set(t.key.toString(),e)},nf.prototype.ze=function(t){var e=this.eh.get(t.toString());return!this.ih.has(t.toString())&&e?ks.updateTime(e):ks.Ye()},nf.prototype.ah=function(t){var e=this.eh.get(t.toString());if(this.ih.has(t.toString())||!e)return ks.exists(!0);if(e.isEqual(Oi.min()))throw new Tr(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ks.updateTime(e)},nf.prototype.write=function(t){this.oh(),this.mutations=this.mutations.concat(t)},nf.prototype.oh=function(){},nf),$l=(ef.prototype.run=function(){this.lh()},ef.prototype.lh=function(){var t=this;this.Xn.yn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Jl(this.jo),(n=this._h(e))&&n.then(function(t){r.On.jn(function(){return e.commit().then(function(){r.qn.resolve(t)}).catch(function(t){r.fh(t)})})}).catch(function(t){r.fh(t)}),[2]})})})},ef.prototype._h=function(t){try{var e=this.updateFunction(t);return!Ui(e)&&e.catch&&e.then?e:(this.qn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qn.reject(t),null}},ef.prototype.fh=function(t){var e=this;0<this.hh&&this.dh(t)?(--this.hh,this.On.jn(function(){return e.lh(),Promise.resolve()})):this.qn.reject(t)},ef.prototype.dh=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!zi(t)},ef),Zl=(tf.prototype.start=function(t,e,n,r){var i=this;this.mh(),this.sa=t;var o=new ca,s=!1;return this.credentials.Wr(function(t){return s?void i.On.os(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).On.hs(),Or("RemoteStore","RemoteStore received new credentials"),n=Bh(e),e.Ko.add(3),[4,kh(e)];case 1:return t.sent(),n&&e.Xo.set("Unknown"),[4,e.Wo.ba(i)];case 2:return t.sent(),e.Ko.delete(3),[4,Uh(e)];case 3:return t.sent(),[2]}})})}(i.gu,t)}):(s=!0,Or("FirestoreClient","Initializing. user=",t.uid),i.Th(e,n,r,t,o).then(i.wh.resolve,i.wh.reject))}),this.On.jn(function(){return i.wh.promise}),o.promise},tf.prototype.enableNetwork=function(){var e=this;return this.mh(),this.On.enqueue(function(){return e.persistence.Oc(!0),(t=e.gu).Ko.delete(0),Uh(t);var t})},tf.prototype.Th=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={On:this.On,sa:this.sa,clientId:this.clientId,credentials:this.credentials,Ra:s,vu:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Vu=r.Vu,this.Qo=r.Qo,this.Ea=r.Ea,this.jo=i.jo,this.gu=i.gu,this.Va=i.Va,this.Eh=i.pu,this.Eh.Is=sc.bind(null,this.Va),this.Eh.ys=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Su.get(o),1<(r=e.Du.get(n.targetId)).length?[2,(e.Du.set(n.targetId,r.filter(function(t){return!Du(t,o)})),void e.Su.delete(o))]:e.Mu?(e.Vu.Hs(n.targetId),e.Vu.Zs(n.targetId)?[3,2]:[4,ih(e.Qo,n.targetId,!1).then(function(){e.Vu.Js(n.targetId),Ch(e.gu,n.targetId),fc(e,n.targetId)}).catch(sh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return fc(e,n.targetId),[4,ih(e.Qo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.Va),this.persistence.kc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Ih(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Th(new Zc,new tl,{ya:!1},s,u))];case 4:return[2]}})})},tf.prototype.Ih=function(t){return"FirebaseError"===t.name?t.code===Ir.FAILED_PRECONDITION||t.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},tf.prototype.mh=function(){if(this.On.ts)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},tf.prototype.disableNetwork=function(){var t=this;return this.mh(),this.On.enqueue(function(){return t.persistence.Oc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ko.add(0),[4,kh(e)];case 1:return t.sent(),e.Xo.set("Offline"),[2]}})})}(t.gu)})},tf.prototype.terminate=function(){var t=this;this.On.rs();var n=new ca;return this.On.es(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ea&&this.Ea.stop(),[4,jh(this.gu)];case 1:return t.sent(),[4,this.Vu.ni()];case 2:return t.sent(),[4,this.persistence.ni()];case 3:return t.sent(),this.credentials.Gr(),n.resolve(),[3,5];case 4:return e=t.sent(),e=Ea(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},tf.prototype.waitForPendingWrites=function(){var t=this;this.mh();var e=new ca;return this.On.jn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Bh((n=o).gu)||Or("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Qo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.li.zu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.ku.get(r)||[]).push(s),n.ku.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ea(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.Va,e)}),e.promise},tf.prototype.listen=function(t,e,n){var r=this;this.mh();var i=new el(n),o=new Oa(t,i,e);return this.On.jn(function(){return Aa(r.Eh,o)}),function(){i.Da(),r.On.jn(function(){return Na(r.Eh,o)})}},tf.prototype.Ah=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new ca,[2,(this.On.jn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.nr.fi(t,e)}))];case 1:return(r=t.sent())instanceof lu?s.resolve(r):r instanceof fu?s.resolve(null):s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ea(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Qo,r,e)}),e.promise)]}})})},tf.prototype.Rh=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new ca,[2,(this.On.jn(function(){return n=a.Eh,r=a.On,i=h,o=c,s=e,t=new el({next:function(t){r.jn(function(){return Na(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Tr(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Oa(mu(i.path),t,{includeMetadataChanges:!0,Ss:!0}),Aa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},tf.prototype.yh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new ca,[2,(this.On.jn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,oh(r,i,!0)];case 1:return n=t.sent(),e=new ec(i,n.Vr),n=e._u(n.documents),n=e.mu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ea(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Qo,r,e)}),e.promise)]}})})},tf.prototype.Ph=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),u=new ca,[2,(this.On.jn(function(){return e=a.Eh,n=a.On,t=h,r=c,i=u,o=new el({next:function(t){n.jn(function(){return Na(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Tr(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Oa(t,o,{includeMetadataChanges:!0,Ss:!0}),Aa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},tf.prototype.write=function(t){var e=this;this.mh();var n=new ca;return this.On.jn(function(){return uc(e.Va,t,n)}),n.promise},tf.prototype.B=function(){return this.sa.B},tf.prototype.gh=function(t){var e=this;this.mh();var r=new el(t);return this.On.jn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Eh,n=r,e.Es.add(n),void n.next())];var e,n})})}),function(){r.Da(),e.On.jn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Eh.Es.delete(r)]})})})}},Object.defineProperty(tf.prototype,"ph",{get:function(){return this.On.ts},enumerable:!1,configurable:!0}),tf.prototype.transaction=function(t){var e=this;this.mh();var n=new ca;return this.On.jn(function(){return new $l(e.On,e.jo,t,n).run(),Promise.resolve()}),n.promise},tf);function tf(t,e){this.credentials=t,this.On=e,this.clientId=li.k(),this.wh=new ca}function ef(t,e,n,r){this.On=t,this.jo=e,this.updateFunction=n,this.qn=r,this.hh=5,this.Xn=new la(this.On,"transaction_retry")}function nf(t){this.jo=t,this.eh=new Map,this.mutations=[],this.nh=!1,this.sh=null,this.ih=new Set}function rf(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var of,sf,uf=(Nf.prototype.Dh=function(t){switch(_o(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xo(t.integerValue||t.doubleValue);case 3:return this.Ch(t.timestampValue);case 4:return this.Fh(t);case 5:return t.stringValue;case 6:return this.Sh(Fo(t.bytesValue));case 7:return this.Nh(t.referenceValue);case 8:return this.$h(t.geoPointValue);case 9:return this.xh(t.arrayValue);case 10:return this.kh(t.mapValue);default:throw Vr()}},Nf.prototype.kh=function(t){var n=this,r={};return kr(t.fields||{},function(t,e){r[t]=n.Dh(e)}),r},Nf.prototype.$h=function(t){return new El(xo(t.latitude),xo(t.longitude))},Nf.prototype.xh=function(t){var e=this;return(t.values||[]).map(function(t){return e.Dh(t)})},Nf.prototype.Fh=function(t){switch(this.Vh){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return Do(e)?t(e):e}(t);return null==e?null:this.Dh(e);case"estimate":return this.Ch(Lo(t));default:return null}},Nf.prototype.Ch=function(t){t=Mo(t),t=new Ri(t.seconds,t.nanos);return this.timestampsInSnapshots?t:t.toDate()},Nf.prototype.Nh=function(t){var e=Mr.P(t);_r(fs(e));t=new Ai(e.get(1),e.get(3)),e=new qr(e.u(5));return t.isEqual(this.B)||Sr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.bh(e)},Nf),af=xa.Oi,hf=(Af.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Af),cf=(Object.defineProperty(Tf.prototype,"zh",{get:function(){return this.Kh||(this.Kh=new Pl(this.Qa,this.Gh.ignoreUndefinedProperties)),this.Kh},enumerable:!1,configurable:!0}),Tf.prototype.settings=function(t){Hr("Firestore.settings",arguments,1),Yr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Gh),t)).merge;t=new hf(t);if(this.Bh&&!this.Gh.isEqual(t))throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Gh=t).credentials&&(this.Wh=function(t){if(!t)return new dh;switch(t.type){case"gapi":var e=t.client;return _r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new gh(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Tr(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Tf.prototype.enableNetwork=function(){return this.Uh(),this.Bh.enableNetwork()},Tf.prototype.disableNetwork=function(){return this.Uh(),this.Bh.disableNetwork()},Tf.prototype.enablePersistence=function(t){var e;if(this.Bh)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Sr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Tr(Ir.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Hh(this.Oh,this.Lh,{ya:!0,cacheSizeBytes:this.Gh.cacheSizeBytes,synchronizeTabs:n,Yh:r})},Tf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Bh&&!this.Bh.ph)throw new Tr(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ca,[2,(this.qh.es(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Oh.clearPersistence(this.Qa,this.jh)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Tf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Tf.prototype,"Jh",{get:function(){return this.Uh(),this.Bh.ph},enumerable:!1,configurable:!0}),Tf.prototype.waitForPendingWrites=function(){return this.Uh(),this.Bh.waitForPendingWrites()},Tf.prototype.onSnapshotsInSync=function(t){if(this.Uh(),rf(t))return this.Bh.gh(t);Yr("Firestore.onSnapshotsInSync","function",1,t);t={next:t};return this.Bh.gh(t)},Tf.prototype.Uh=function(){return this.Bh||this.Hh(new Zc,new tl,{ya:!1}),this.Bh},Tf.prototype.Xh=function(){return new Ei(this.Qa,this.jh,this.Gh.host,this.Gh.ssl,this.Gh.experimentalForceLongPolling,this.Gh.experimentalAutoDetectLongPolling)},Tf.prototype.Hh=function(t,e,n){var r=this.Xh();return this.Bh=new Zl(this.Wh,this.qh),this.Bh.start(r,t,e,n)},Tf.Qh=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Tr(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new Tr(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ai(t)},Object.defineProperty(Tf.prototype,"app",{get:function(){if(!this.Mh)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Mh},enumerable:!1,configurable:!0}),Tf.prototype.collection=function(t){return Hr("Firestore.collection",arguments,1),Yr("Firestore.collection","non-empty string",1,t),this.Uh(),new Uf(Mr.P(t),this,null)},Tf.prototype.doc=function(t){return Hr("Firestore.doc",arguments,1),Yr("Firestore.doc","non-empty string",1,t),this.Uh(),pf.Zh(Mr.P(t),this,null)},Tf.prototype.collectionGroup=function(t){if(Hr("Firestore.collectionGroup",arguments,1),Yr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Uh(),new Vf((t=t,new du(Mr.g(),t)),this,null)},Tf.prototype.runTransaction=function(e){var n=this;return Hr("Firestore.runTransaction",arguments,1),Yr("Firestore.runTransaction","function",1,e),this.Uh().transaction(function(t){return e(new lf(n,t))})},Tf.prototype.batch=function(){return this.Uh(),new ff(this)},Object.defineProperty(Tf,"logLevel",{get:function(){switch(Rr()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Tf.setLogLevel=function(t){Hr("Firestore.setLogLevel",arguments,1),ei("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ar.setLogLevel(t)},Tf.prototype.tl=function(){return this.Gh.timestampsInSnapshots},Tf.prototype.el=function(){return this.Gh},Tf),lf=(If.prototype.get=function(t){var e=this;Hr("Transaction.get",arguments,1);var n=Ff("Transaction.get",t,this.nl);return this.sl.rh([n.ja]).then(function(t){if(!t||1!==t.length)return Vr();t=t[0];if(t instanceof fu)return new yf(e.nl,n.ja,null,!1,!1,n.Wa);if(t instanceof lu)return new yf(e.nl,n.ja,t,!1,!1,n.Wa);throw Vr()})},If.prototype.set=function(t,e,n){Kr("Transaction.set",arguments,2,3);t=Ff("Transaction.set",t,this.nl);n=Cf("Transaction.set",n);e=qf(t.Wa,e,n),n=xl(this.nl.zh,"Transaction.set",t.ja,e,null!==t.Wa,n);return this.sl.set(t.ja,n),this},If.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof rl?(Xr("Transaction.update",arguments,3),r=Ff("Transaction.update",t,this.nl),ql(this.nl.zh,"Transaction.update",r.ja,e,n,i)):(Hr("Transaction.update",arguments,2),r=Ff("Transaction.update",t,this.nl),Fl(this.nl.zh,"Transaction.update",r.ja,e)),this.sl.update(r.ja,e),this},If.prototype.delete=function(t){Hr("Transaction.delete",arguments,1);t=Ff("Transaction.delete",t,this.nl);return this.sl.delete(t.ja),this},If),ff=(Ef.prototype.set=function(t,e,n){Kr("WriteBatch.set",arguments,2,3),this.ol();t=Ff("WriteBatch.set",t,this.nl);n=Cf("WriteBatch.set",n);e=qf(t.Wa,e,n),n=xl(this.nl.zh,"WriteBatch.set",t.ja,e,null!==t.Wa,n);return this.il=this.il.concat(n.Ga(t.ja,ks.Ye())),this},Ef.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.ol(),e="string"==typeof e||e instanceof rl?(Xr("WriteBatch.update",arguments,3),r=Ff("WriteBatch.update",t,this.nl),ql(this.nl.zh,"WriteBatch.update",r.ja,e,n,i)):(Hr("WriteBatch.update",arguments,2),r=Ff("WriteBatch.update",t,this.nl),Fl(this.nl.zh,"WriteBatch.update",r.ja,e)),this.il=this.il.concat(e.Ga(r.ja,ks.exists(!0))),this},Ef.prototype.delete=function(t){Hr("WriteBatch.delete",arguments,1),this.ol();t=Ff("WriteBatch.delete",t,this.nl);return this.il=this.il.concat(new tu(t.ja,ks.Ye())),this},Ef.prototype.commit=function(){return this.ol(),this.rl=!0,0<this.il.length?this.nl.Uh().write(this.il):Promise.resolve()},Ef.prototype.ol=function(){if(this.rl)throw new Tr(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ef),pf=(n(bf,sf=Al),bf.Zh=function(t,e,n){if(t.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new bf(new qr(t),e,n)},Object.defineProperty(bf.prototype,"id",{get:function(){return this.ja.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"parent",{get:function(){return new Uf(this.ja.path.h(),this.firestore,this.Wa)},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"path",{get:function(){return this.ja.path.R()},enumerable:!1,configurable:!0}),bf.prototype.collection=function(t){if(Hr("DocumentReference.collection",arguments,1),Yr("DocumentReference.collection","non-empty string",1,t),!t)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=Mr.P(t);return new Uf(this.ja.path.child(t),this.firestore,null)},bf.prototype.isEqual=function(t){if(!(t instanceof bf))throw ui("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ja.isEqual(t.ja)&&this.Wa===t.Wa},bf.prototype.set=function(t,e){Kr("DocumentReference.set",arguments,1,2),e=Cf("DocumentReference.set",e);t=qf(this.Wa,t,e),e=xl(this.firestore.zh,"DocumentReference.set",this.ja,t,null!==this.Wa,e);return this.Bh.write(e.Ga(this.ja,ks.Ye()))},bf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof rl?(Xr("DocumentReference.update",arguments,2),ql(this.firestore.zh,"DocumentReference.update",this.ja,t,e,n)):(Hr("DocumentReference.update",arguments,1),Fl(this.firestore.zh,"DocumentReference.update",this.ja,t)),this.Bh.write(t.Ga(this.ja,ks.exists(!0)))},bf.prototype.delete=function(){return Hr("DocumentReference.delete",arguments,0),this.Bh.write([new tu(this.ja,ks.Ye())])},bf.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Kr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||rf(n[i])||(si("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),Zr("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};rf(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Yr("DocumentReference.onSnapshot","function",i,n[i]),Jr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Jr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.ul(t))},error:n[i+1],complete:n[i+2]};return this.Bh.listen(mu(this.ja.path),o,s)},bf.prototype.get=function(t){var e=this;Kr("DocumentReference.get",arguments,0,1),xf("DocumentReference.get",t);var n=this.firestore.Uh();return t&&"cache"===t.source?n.Ah(this.ja).then(function(t){return new yf(e.firestore,e.ja,t,!0,t instanceof lu&&t.Je,e.Wa)}):n.Rh(this.ja,t).then(function(t){return e.ul(t)})},bf.prototype.withConverter=function(t){return new bf(this.ja,this.firestore,t)},bf.prototype.ul=function(t){var e=t.docs.get(this.ja);return new yf(this.firestore,this.ja,e,t.fromCache,t.hasPendingWrites,this.Wa)},bf),df=(wf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},wf),yf=(mf.prototype.data=function(t){var e=this;if(Kr("DocumentSnapshot.data",arguments,0,1),t=Mf("DocumentSnapshot.data",t),this.cl){if(this.Wa){var n=new vf(this.nl,this.ja,this.cl,this.al,this.hl,null);return this.Wa.fromFirestore(n,t)}return new uf(this.nl.Qa,this.nl.tl(),t.serverTimestamps||"none",function(t){return new pf(t,e.nl,null)},function(t){return new Ti(t)}).Dh(this.cl.rn())}},mf.prototype.get=function(t,e){var n=this;if(Kr("DocumentSnapshot.get",arguments,1,2),e=Mf("DocumentSnapshot.get",e),this.cl){t=this.cl.data().field(Hl("DocumentSnapshot.get",t,this.ja));if(null!==t)return new uf(this.nl.Qa,this.nl.tl(),e.serverTimestamps||"none",function(t){return new pf(t,n.nl,n.Wa)},function(t){return new Ti(t)}).Dh(t)}},Object.defineProperty(mf.prototype,"id",{get:function(){return this.ja.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(mf.prototype,"ref",{get:function(){return new pf(this.ja,this.nl,this.Wa)},enumerable:!1,configurable:!0}),Object.defineProperty(mf.prototype,"exists",{get:function(){return null!==this.cl},enumerable:!1,configurable:!0}),Object.defineProperty(mf.prototype,"metadata",{get:function(){return new df(this.hl,this.al)},enumerable:!1,configurable:!0}),mf.prototype.isEqual=function(t){if(!(t instanceof mf))throw ui("isEqual","DocumentSnapshot",1,t);return this.nl===t.nl&&this.al===t.al&&this.ja.isEqual(t.ja)&&(null===this.cl?null===t.cl:this.cl.isEqual(t.cl))&&this.Wa===t.Wa},mf),vf=(n(gf,of=yf),gf.prototype.data=function(t){return of.prototype.data.call(this,t)},gf);function gf(){return null!==of&&of.apply(this,arguments)||this}function mf(t,e,n,r,i,o){this.nl=t,this.ja=e,this.cl=n,this.al=r,this.hl=i,this.Wa=o}function wf(t,e){this.hasPendingWrites=t,this.fromCache=e}function bf(t,e,n){var r=this;return(r=sf.call(this,e.Qa,t,n)||this).ja=t,r.firestore=e,r.Wa=n,r.Bh=r.firestore.Uh(),r}function Ef(t){this.nl=t,this.il=[],this.rl=!1}function If(t,e){this.nl=t,this.sl=e}function Tf(t,e,n,r){var i=this;if(void 0===n&&(n=new Zc),void 0===r&&(r=new tl),this.Oh=n,this.Lh=r,this.Mh=null,this.qh=new ma,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Uh(),[4,this.Bh.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){r=t;this.Mh=r,this.Qa=Tf.Qh(r),this.jh=r.name,this.Wh=new yh(e)}else{t=t;if(!t.projectId)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide projectId");this.Qa=new Ai(t.projectId,t.database),this.jh="[DEFAULT]",this.Wh=new dh}this.Gh=new hf({})}function Af(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Tr(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else $r("settings","non-empty string","host",t.host),this.host=t.host,Zr("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(si("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","experimentalAutoDetectLongPolling","ignoreUndefinedProperties"]),Zr("settings","object","credentials",t.credentials),this.credentials=t.credentials,Zr("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Zr("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Sr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Sr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,Zr("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=xa.Mi;else{if(t.cacheSizeBytes!==af&&t.cacheSizeBytes<xa.Li)throw new Tr(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+xa.Li);this.cacheSizeBytes=t.cacheSizeBytes}Zr("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(e=t.experimentalForceLongPolling)&&void 0!==e&&e,Zr("settings","boolean","experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalAutoDetectLongPolling=null!==(e=t.experimentalAutoDetectLongPolling)&&void 0!==e&&e,function(t,e){if(!0===t&&!0===e)throw new Tr(Ir.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(t.experimentalForceLongPolling,t.experimentalAutoDetectLongPolling)}function Nf(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.Vh=n,this.bh=r,this.Sh=i}function Rf(t,e,n){if("string"==typeof n){if(""===n)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Tu(e)&&-1!==n.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(Mr.P(n));if(!qr.N(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return qo(t,new qr(e))}if(n instanceof Al)return qo(t,n.ja);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ii(n)+".")}function Of(t,e){if(!Array.isArray(t)||0===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Sf(t,e,n){if(!n.isEqual(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Df(t){if(bu(t)&&0===t.on.length)throw new Tr(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Lf,Vf=(Pf.prototype.where=function(t,e,n){Hr("Query.where",arguments,3),oi("Query.where",3,n);e=ei("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=Hl("Query.where",t),e=function(t,e,n,r,i,o,s){if(i.V()){if("array-contains"===o||"array-contains-any"===o)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Of(s,o);for(var u=[],a=0,h=s;a<h.length;a++){var c=h[a];u.push(Rf(r,t,c))}l={arrayValue:{values:u}}}else l=Rf(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Of(s,o),l=Bl(n,e,s,"in"===o||"not-in"===o);var l=ju.create(i,o,l);return function(t,e){if(e.hn()){var n=Iu(t);if(null!==n&&!n.isEqual(e.field))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Eu(t);null!==n&&Sf(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,l),l}(this.ll,"Query.where",this.firestore.zh,this.firestore.Qa,t,e,n);return new Pf((n=this.ll,e=n.filters.concat([e]),new du(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.un,n.startAt,n.endAt)),this.firestore,this.Wa)},Pf.prototype.orderBy=function(t,e){if(Kr("Query.orderBy",arguments,1,2),Jr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Hl("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ha(e,n);return e=r,null!==Eu(n=t)||null!==(t=Iu(n))&&Sf(0,t,e.field),r}(this.ll,t,n);return new Pf((n=this.ll,t=n.on.concat([t]),new du(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.un,n.startAt,n.endAt)),this.firestore,this.Wa)},Pf.prototype.limit=function(t){return Hr("Query.limit",arguments,1),Yr("Query.limit","number",1,t),ai("Query.limit",1,t),new Pf(Ru(this.ll,t,"F"),this.firestore,this.Wa)},Pf.prototype.limitToLast=function(t){return Hr("Query.limitToLast",arguments,1),Yr("Query.limitToLast","number",1,t),ai("Query.limitToLast",1,t),new Pf(Ru(this.ll,t,"L"),this.firestore,this.Wa)},Pf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.startAt",arguments,1);t=this._l("Query.startAt",t,e,!0);return new Pf(Ou(this.ll,t),this.firestore,this.Wa)},Pf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.startAfter",arguments,1);t=this._l("Query.startAfter",t,e,!1);return new Pf(Ou(this.ll,t),this.firestore,this.Wa)},Pf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.endBefore",arguments,1);t=this._l("Query.endBefore",t,e,!0);return new Pf(Su(this.ll,t),this.firestore,this.Wa)},Pf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Xr("Query.endAt",arguments,1);t=this._l("Query.endAt",t,e,!1);return new Pf(Su(this.ll,t),this.firestore,this.Wa)},Pf.prototype.isEqual=function(t){if(!(t instanceof Pf))throw ui("isEqual","Query",1,t);return this.firestore===t.firestore&&Du(this.ll,t.ll)&&this.Wa===t.Wa},Pf.prototype.withConverter=function(t){return new Pf(this.ll,this.firestore,t)},Pf.prototype._l=function(h,t,e,n){if(oi(h,1,t),t instanceof yf)return Hr(h,i([t],e),1),function(t,e,n,r){if(!n)throw new Tr(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Au(t);o<s.length;o++){var u=s[o];if(u.field.V())i.push(qo(e,n.key));else{var a=n.field(u.field);if(Do(a))throw new Tr(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.R();throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new ea(i,r)}(this.ll,this.firestore.Qa,t.cl,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new Tr(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.V()){if("string"!=typeof h)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Tu(t)&&-1!==h.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Mr.P(h));if(!qr.N(c))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new qr(c);u.push(qo(e,c))}else{h=Bl(n,r,h);u.push(h)}}return new ea(u,o)}(this.ll,this.firestore.Qa,this.firestore.zh,h,e,n)},Pf.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Kr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||rf(n[o])||(si("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),Zr("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),rf(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Yr("Query.onSnapshot","function",o,n[o]),Jr("Query.onSnapshot","function",o+1,n[o+1]),Jr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new _f(e.firestore,e.ll,t,e.Wa))},error:n[o+1],complete:n[o+2]};return Df(this.ll),this.firestore.Uh().listen(this.ll,i,s)},Pf.prototype.get=function(t){var e=this;Kr("Query.get",arguments,0,1),xf("Query.get",t),Df(this.ll);var n=this.firestore.Uh();return(t&&"cache"===t.source?n.yh(this.ll):n.Ph(this.ll,t)).then(function(t){return new _f(e.firestore,e.ll,t,e.Wa)})},Pf),_f=(Object.defineProperty(jf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"empty",{get:function(){return this.dl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"size",{get:function(){return this.dl.docs.size},enumerable:!1,configurable:!0}),jf.prototype.forEach=function(e,n){var r=this;Kr("QuerySnapshot.forEach",arguments,1,2),Yr("QuerySnapshot.forEach","function",1,e),this.dl.docs.forEach(function(t){e.call(n,r.Tl(t,r.metadata.fromCache,r.dl.jt.has(t.key)))})},Object.defineProperty(jf.prototype,"query",{get:function(){return new Vf(this.fl,this.nl,this.Wa)},enumerable:!1,configurable:!0}),jf.prototype.docChanges=function(t){t&&(si("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Zr("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));t=!(!t||!t.includeMetadataChanges);if(t&&this.dl.Gt)throw new Tr(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.wl&&this.ml===t||(this.wl=function(i,e,o){if(i.Qt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.jt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Qt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.jt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Vr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.dl,t,this.Tl.bind(this)),this.ml=t),this.wl},jf.prototype.isEqual=function(t){if(!(t instanceof jf))throw ui("isEqual","QuerySnapshot",1,t);return this.nl===t.nl&&Du(this.fl,t.fl)&&this.dl.isEqual(t.dl)&&this.Wa===t.Wa},jf.prototype.Tl=function(t,e,n){return new vf(this.nl,t.key,t,e,n,this.Wa)},jf),Uf=(n(kf,Lf=Vf),Object.defineProperty(kf.prototype,"id",{get:function(){return this.ll.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(kf.prototype,"parent",{get:function(){var t=this.ll.path.h();return t.m()?null:new pf(new qr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(kf.prototype,"path",{get:function(){return this.ll.path.R()},enumerable:!1,configurable:!0}),kf.prototype.doc=function(t){Kr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=li.k()),Yr("CollectionReference.doc","non-empty string",1,t);t=Mr.P(t);return pf.Zh(this.ll.path.child(t),this.firestore,this.Wa)},kf.prototype.add=function(t){Hr("CollectionReference.add",arguments,1);t=this.Wa?this.Wa.toFirestore(t):t;Yr("CollectionReference.add","object",1,t);var e=this.doc();return new pf(e.ja,this.firestore,null).set(t).then(function(){return e})},kf.prototype.withConverter=function(t){return new kf(this.El,this.firestore,t)},kf);function kf(t,e,n){var r=this;if(((r=Lf.call(this,mu(t),e,n)||this).El=t).length%2!=1)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function jf(t,e,n,r){this.nl=t,this.fl=e,this.dl=n,this.Wa=r,this.wl=null,this.ml=null,this.metadata=new df(n.hasPendingWrites,n.fromCache)}function Pf(t,e,n){this.ll=t,this.firestore=e,this.Wa=n}function Cf(t,e){if(void 0===e)return{merge:!1};if(si(t,e,["merge","mergeFields"]),Zr(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ii(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ii(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof rl}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Mf(t,e){return void 0===e?{}:(si(t,e,["serverTimestamps"]),ti(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function xf(t,e){Jr(t,"object",1,e),e&&(si(t,e,["source"]),ti(t,0,"source",e.source,["default","server","cache"]))}function Ff(t,e,n){if(e instanceof Al){if(e.firestore!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ui(t,"DocumentReference",1,e)}function qf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Bf,Gf,l=(n(Wf,Bf=Il),Wf.serverTimestamp=function(){Qr("FieldValue.serverTimestamp",arguments);var t=new gl("serverTimestamp");return t.Fa="FieldValue.serverTimestamp",new Wf(t)},Wf.delete=function(){Qr("FieldValue.delete",arguments);var t=new sl("deleteField");return t.Fa="FieldValue.delete",new Wf(t)},Wf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayUnion()",arguments,1),new ml("arrayUnion",t)}.apply(void 0,t);return n.Fa="FieldValue.arrayUnion",new Wf(n)},Wf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayRemove()",arguments,1),new wl("arrayRemove",t)}.apply(void 0,t);return n.Fa="FieldValue.arrayRemove",new Wf(n)},Wf.increment=function(t){Yr("FieldValue.increment","number",1,t),Hr("FieldValue.increment",arguments,1);t=new bl("increment",t);return t.Fa="FieldValue.increment",new Wf(t)},Wf.prototype.isEqual=function(t){return this.Ba.isEqual(t.Ba)},Wf),zf={Firestore:cf,GeoPoint:El,Timestamp:Ri,Blob:Ti,Transaction:lf,WriteBatch:ff,DocumentReference:pf,DocumentSnapshot:yf,Query:Vf,QueryDocumentSnapshot:vf,QuerySnapshot:_f,CollectionReference:Uf,FieldPath:rl,FieldValue:l,setLogLevel:cf.setLogLevel,CACHE_SIZE_UNLIMITED:af};function Wf(){return null!==Bf&&Bf.apply(this,arguments)||this}(Gf=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new cf(e,t,new Zc,new tl);var e},"PUBLIC").setServiceProps(Object.assign({},zf))),Gf.registerVersion("@firebase/firestore","1.18.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
